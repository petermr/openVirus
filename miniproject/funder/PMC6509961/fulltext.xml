<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?subarticle report48153?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing3.dtd?><?SourceDTD.Version 3.0?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">F1000Res</journal-id><journal-id journal-id-type="iso-abbrev">F1000Res</journal-id><journal-id journal-id-type="pmc">F1000Research</journal-id><journal-title-group><journal-title>F1000Research</journal-title></journal-title-group><issn pub-type="epub">2046-1402</issn><publisher><publisher-name>F1000 Research Limited</publisher-name><publisher-loc>London, UK</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6509961</article-id><article-id pub-id-type="doi">10.12688/f1000research.18002.1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software Tool Article</subject></subj-group><subj-group><subject>Articles</subject></subj-group></article-categories><title-group><article-title>Epidemic curves made easy using the R package
<italic>incidence</italic>
</article-title><fn-group content-type="pub-status"><fn><p>[version 1; peer review: 1 approved</p></fn></fn-group></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kamvar</surname><given-names>Zhian N.</given-names></name><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Original Draft Preparation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Review &#x00026; Editing</role><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1458-7108</contrib-id><xref ref-type="corresp" rid="c1">a</xref><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Cai</surname><given-names>Jun</given-names></name><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Original Draft Preparation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Review &#x00026; Editing</role><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9495-1226</contrib-id><xref ref-type="aff" rid="a2">2</xref></contrib><contrib contrib-type="author"><name><surname>Pulliam</surname><given-names>Juliet R.C.</given-names></name><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Review &#x00026; Editing</role><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3314-8223</contrib-id><xref ref-type="aff" rid="a3">3</xref></contrib><contrib contrib-type="author"><name><surname>Schumacher</surname><given-names>Jakob</given-names></name><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Review &#x00026; Editing</role><xref ref-type="aff" rid="a4">4</xref></contrib><contrib contrib-type="author"><name><surname>Jombart</surname><given-names>Thibaut</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Funding Acquisition</role><role content-type="http://credit.casrai.org/">Project Administration</role><role content-type="http://credit.casrai.org/">Resources</role><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Original Draft Preparation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; Review &#x00026; Editing</role><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2226-8692</contrib-id><xref ref-type="corresp" rid="c2">b</xref><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a5">5</xref></contrib><aff id="a1">
<label>1</label>MRC Centre for Outbreak Analysis and Modelling, Department of Infectious Disease Epidemiology , School of Public Health, Imperial College London, London, UK</aff><aff id="a2">
<label>2</label>Ministry of Education Key Laboratory for Earth System Modelling, Department of Earth System Science, Tsinghua University, Beijing, 100084, China</aff><aff id="a3">
<label>3</label>South African DST-NRF Centre of Excellence in Epidemiological Modelling and Analysis (SACEMA),, Stellenbosch University, Stellenbosch, South Africa</aff><aff id="a4">
<label>4</label>Gesundheitsamt Reinickendorf, Berlin, Germany</aff><aff id="a5">
<label>5</label>Department of Infectious Disease Epidemiology, London School of Hygiene &#x00026; Tropical Medicine, London, UK</aff></contrib-group><author-notes><corresp id="c1"><label>a</label><email xlink:href="mailto:zkamvar@gmail.com">zkamvar@gmail.com</email></corresp><corresp id="c2"><label>b</label><email xlink:href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</email></corresp><fn fn-type="COI-statement"><p>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>31</day><month>1</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>139</elocation-id><history><date date-type="accepted"><day>22</day><month>1</month><year>2019</year></date></history><permissions><copyright-statement>Copyright: &#x000a9; 2019 Kamvar ZN et al.</copyright-statement><copyright-year>2019</copyright-year><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-8-19688.pdf"/><abstract><p>The epidemiological curve (epicurve) is one of the simplest yet most useful tools used by field epidemiologists, modellers, and decision makers for assessing the dynamics of infectious disease epidemics. Here, we present the free, open-source package incidence for the R programming language, which allows users to easily compute, handle, and visualise epicurves from unaggregated linelist data. This package was built in accordance with the development guidelines of the R Epidemics Consortium (RECON), which aim to ensure robustness and reliability through extensive automated testing, documentation, and good coding practices. As such, it fills an important gap in the toolbox for outbreak analytics using the R software, and provides a solid building block for further developments in infectious disease modelling.
<italic>incidence</italic> is available from
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/incidence">https://www.repidemicsconsortium.org/incidence</ext-link>.</p></abstract><kwd-group kwd-group-type="author"><kwd>epicurve</kwd><kwd>incidence</kwd><kwd>epidemics</kwd><kwd>outbreaks</kwd><kwd>R</kwd></kwd-group><funding-group><award-group id="fund-1"><funding-source>National Institute for Health Research - Health Protection Research Unit for Modelling Methodology</funding-source></award-group><award-group id="fund-2"><funding-source>United Kingdom Department of Health and Social Care</funding-source></award-group><award-group id="fund-3"><funding-source>Global Challenges Research Fund (GCRF)</funding-source><award-id>ES/P010873/1</award-id></award-group><funding-statement>The authors acknowledge financial support from the Global Challenges Research Fund (GCRF) for the project &#x02018;RECAP &#x02013; research capacity building and knowledge generation to support preparedness and response to humanitarian crises and epidemics&#x02019; managed through RCUK and ESRC (ES/P010873/1), from the UK Public Health Rapid Support Team, which is funded by the United Kingdom Department of Health and Social Care, and from the National Institute for Health Research - Health Protection Research Unit for Modelling Methodology.</funding-statement><funding-statement><italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic></funding-statement></funding-group></article-meta></front><body><sec sec-type="intro"><title>Introduction</title><p>Responses to infectious disease epidemics use a growing body of data sources to inform decision making (
<xref rid="ref-4" ref-type="bibr">Cori
<italic>et al</italic>., 2017</xref>;
<xref rid="ref-1" ref-type="bibr">Fraser
<italic>et al</italic>., 2009</xref>;
<xref rid="ref-2" ref-type="bibr">WHO Ebola Response Team
<italic>et al.</italic>, 2014</xref>;
<xref rid="ref-3" ref-type="bibr">WHO Ebola Response Team
<italic>et al</italic>., 2015</xref>). While new data&#x02014;such as whole genome pathogen sequences&#x02014;are increasingly useful complements to epidemiological data (
<xref rid="ref-5" ref-type="bibr">Gire
<italic>et al</italic>., 2014</xref>), epidemic curves&#x02014;which describe the number of new cases through time (incidence)&#x02014;remain the most important source of information, particularly early in an outbreak. Specifically epidemic curves(often referred to as &#x02018;epicurves&#x02019;) represent the number of new cases per time unit based on the date or time of symptom onset.</p><p>While conceptually simple, epicurves are useful in many respects. They provide a simple, visual outline of epidemic dynamics, which can be used for assessing the growth or decline of an outbreak (
<xref rid="ref-8" ref-type="bibr">Barrett
<italic>et al</italic>., 2016</xref>;
<xref rid="ref-7" ref-type="bibr">Fitzgerald
<italic>et al</italic>., 2014</xref>;
<xref rid="ref-10" ref-type="bibr">Jernberg
<italic>et al</italic>., 2015</xref>;
<xref rid="ref-9" ref-type="bibr">Lanini
<italic>et al</italic>., 2014</xref>;
<xref rid="ref-6" ref-type="bibr">Nhan
<italic>et al</italic>., 2018</xref>) and therefore informing intervention measures (
<xref rid="ref-11" ref-type="bibr">Meltzer
<italic>et al</italic>., 2014</xref>;
<xref rid="ref-2" ref-type="bibr">WHO Ebola Response Team
<italic>et al.</italic>, 2014</xref>;
<xref rid="ref-3" ref-type="bibr">WHO Ebola Response Team
<italic>et al</italic>., 2015</xref>). In addition, epicurves also form the raw material used by a range of modelling techniques for short-term forecasting (
<xref rid="ref-12" ref-type="bibr">Cori
<italic>et al</italic>., 2013</xref>;
<xref rid="ref-13" ref-type="bibr">Funk
<italic>et al</italic>., 2018</xref>;
<xref rid="ref-14" ref-type="bibr">Nouvellet
<italic>et al</italic>., 2018</xref>;
<xref rid="ref-15" ref-type="bibr">Viboud
<italic>et al</italic>., 2018</xref>) as well as in outbreak detection algorithms from syndromic surveillance data (
<xref rid="ref-16" ref-type="bibr">Farrington &#x00026; Andrews, 2003</xref>;
<xref rid="ref-17" ref-type="bibr">Unkel
<italic>et al</italic>., 2012</xref>).</p><p>Because of the increasing need to analyse various types of epidemiological data in a single environment using free, transparent and reproducible procedures, the R software (
<xref rid="ref-18" ref-type="bibr">R Core Team, 2017</xref>) has been proposed as a platform of choice for epidemic analysis (
<xref rid="ref-19" ref-type="bibr">Jombart
<italic>et al</italic>., 2014</xref>). But despite the existence of packages dedicated to time series analysis (
<xref rid="ref-20" ref-type="bibr">Shumway &#x00026; Stoffer, 2010</xref>) as well as surveillance data (
<xref rid="ref-21" ref-type="bibr">H&#x000f6;hle, 2007</xref>), a lightweight and
<italic>well-tested</italic> package solely dedicated to building, handling and plotting epidemic curves directly from linelist data (e.g. a spreadsheet where each row represents an individual case) is still lacking.</p><p>Here, we introduce
<italic>incidence</italic>, an R package developed as part of the toolbox for epidemics analysis of the R Epidemics Consortium (
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/">RECON</ext-link>) which aims to fill this gap. In this paper, we outline the package&#x02019;s design and illustrate its functionalities using a reproducible worked example.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Package overview</title><p>The philosophy underpinning the development of
<italic>incidence</italic> is to &#x02018;do the basics well&#x02019;. The objective of this package is to provide simple, user-friendly and robust tools for computing, manipulating, and plotting epidemic curves, with some additional facilities for basic models of incidence over time.</p><p>The general workflow (
<xref ref-type="fig" rid="f1">Figure 1</xref>) revolves around a single type of object, formalised as the S3 class
<bold>incidence</bold>.
<bold>incidence</bold> objects are lists storing separately a matrix of case counts (with dates in rows and groups in columns), dates used as breaks, the time interval used, and an indication of whether incidence is cumulative or not (
<xref ref-type="fig" rid="f1">Figure 1</xref>). The
<bold>incidence</bold> object is obtained by running the function
<monospace>incidence()</monospace> specifying two inputs: a vector of dates (representing onset of individual cases) and an interval specification. The dates can be any type of input representing dates including
<bold>Date</bold> and
<bold>POSIXct</bold> objects, as well as numeric and integer values. The dates are aggregated into counts based on the user-defined interval representing the number of days for each bin. The interval can also be defined as a text string of either "week", "month", "quarter", or "year" to represent intervals that can not be defined by a fixed number of days. For these higher-level intervals, an extra parameter&#x02014;
<monospace>standard</monospace>&#x02014;is available to specify if the interval should start at the standard beginning of the interval (e.g. weeks start on Monday and months start at the first of the month).
<monospace>incidence()</monospace> also accepts a
<monospace>groups</monospace> argument which can be used to obtain stratified incidence. The basic elements of the
<bold>incidence</bold> object can be obtained by the accessors
<monospace>get_counts()</monospace>,
<monospace>get_dates()</monospace>, and
<monospace>get_interval()</monospace>.</p><fig fig-type="figure" id="f1" orientation="portrait" position="anchor"><label>Figure 1. </label><caption><title>Generalized workflow from incidence object construction to modeling and visualization.</title><p>The raw data is depicted in the top left as either a vector of dates for each individual case (typical usage) or a combination of both dates and a matrix of group counts. The incidence object is created from these where it checks and validates the timespan and interval between dates. Data subsetting and export is depicted in the upper right. Data visualization is depicted in the lower right. Addition of log-linear models is depicted in the lower left.</p></caption><graphic xlink:href="f1000research-8-19688-g0000"/></fig><p>This package facilitates the manipulation of
<bold>incidence</bold> objects by providing a set of handler functions for the most common tasks. The function
<monospace>subset()</monospace> can be used for isolating case data from a specific time window and/or groups, while the [ operator can be used for a finer control to subset dates and groups using integer, logical or character vectors. This is accomplished by using the same syntax as for matrix and data.frame objects, i.e.
<monospace>x[i, j]</monospace> where
<monospace>x</monospace> is the
<bold>incidence</bold> object, and
<monospace>i</monospace> and
<monospace>j</monospace> are subsets of dates and groups, respectively.</p><p>The function
<monospace>pool()</monospace> can be used to merge several groups into one, and the function
<monospace>cumulate()</monospace> will turn incidence data into cumulative incidence. To maximize interoperability,
<bold>incidence</bold> objects can also be exported to either a matrix using
<monospace>get_counts()</monospace> or a data.frame using
<monospace>as.data.frame()</monospace>, including an option for a &#x02018;long&#x02019; format which is readily compatible with
<italic>ggplot2</italic> (
<xref rid="ref-22" ref-type="bibr">Wickham, 2016</xref>) for further customization of graphics.</p><p>In line with RECON&#x02019;s development guidelines, the
<italic>incidence</italic> package is thoroughly tested via automatic tests implemented using
<italic>testthat</italic> (
<xref rid="ref-23" ref-type="bibr">Wickham, 2011</xref>), with an overall coverage nearing 100% at all times. We use the continuous integration services
<ext-link ext-link-type="uri" xlink:href="https://travis-ci.org/">travis.ci</ext-link> and
<ext-link ext-link-type="uri" xlink:href="https://ci.appveyor.com/">appveyor</ext-link> to ensure that new versions of the code maintain all existing functionalities and give expected results on known datasets, including matching reference graphics tested using the visual regression testing implemented in
<italic>vdiffr</italic> (
<xref rid="ref-24" ref-type="bibr">Henry
<italic>et al</italic>., 2018</xref>). Overall, these practices aim to maximise the reliability of the package, and its sustainable development and maintenance over time.</p></sec><sec><title>Modeling utilities</title><p>Many different approaches can be used to model, and possibly derive predictions from incidence data (e.g.
<xref rid="ref-12" ref-type="bibr">Cori
<italic>et al</italic>., 2013</xref>;
<xref rid="ref-14" ref-type="bibr">Nouvellet
<italic>et al</italic>., 2018</xref>;
<xref rid="ref-25" ref-type="bibr">Wallinga &#x00026; Teunis, 2004</xref>), and are best implemented in separate packages (e.g.
<xref rid="ref-12" ref-type="bibr">Cori
<italic>et al</italic>., 2013</xref>). Here, we highlight three simple functionalities in
<italic>incidence</italic> for estimating parameters via modeling or bootstrap and the two specialized data classes that are used to store the models and parameter estimates.</p><p>As a basic model, we implement the simple log-linear regression approach in the function
<monospace>fit()</monospace>, which can be used to fit exponential increase or decrease of incidence over time by log-transforming case counts and applying a linear regression on these transformed data. The log-linear regression model is of the form
<italic>log</italic>(
<italic>y</italic>) =
<italic>r &#x000d7; t</italic> +
<italic>b</italic> where
<italic>y</italic> is the incidence,
<italic>r</italic> is the growth rate,
<italic>t</italic> is the number of days since the start of the outbreak, and
<italic>b</italic> is the intercept. This approach estimates a growth rate
<italic>r</italic> (the slope of the regression), which can in turn be used for estimating the doubling or halving time of the epidemic, and with some knowledge of the serial interval, for approximating the reproduction number,
<italic>R</italic>
<sub>0</sub> (
<xref rid="ref-26" ref-type="bibr">Wallinga &#x00026; Lipsitch, 2007</xref>).</p><p>In the presence of both growing and decreasing phases of an epidemic, the date representing the peak of the epidemic can be estimated. In
<italic>incidence</italic>, this can be done in two ways. The function
<monospace>estimate_peak()</monospace> uses multinomial bootstrapping to estimate the peak, assuming that a) reporting is constant over time, b) the total number of cases is known, and c) the bootstrap never samples zero-incidence days. This function returns the estimated peak with a confidence interval along with the boostrap estimates. Alternatively, the function
<monospace>fit_optim_split()</monospace> can be used to detect the optimal turning point of the epidemic and fit two separate models on either side of the peak. This is done by maximizing the combined mean adjusted
<italic>R</italic>
<sup>2</sup> value from the two models (
<xref ref-type="fig" rid="f1">Figure 1</xref>,
<xref ref-type="fig" rid="f5">Figure 5</xref>).</p><p>The
<monospace>fit()</monospace> function returns an
<bold>incidence_fit</bold> object and the
<monospace>fit_optim_split()</monospace> function returns an
<bold>incidence_fit_list</bold> object, which is a specialized object designed to contain an unlimited number of (potentially nested)
<bold>incidence_fit</bold> objects. While the
<italic>incidence</italic> package returns
<bold>incidence_fit</bold> objects containing log-linear models by default, they can be constructed from any model from which it&#x02019;s possible to extract the growth rate (
<italic>r</italic>) and predict incidence along the model. Both object classes can be plotted separately or added to an existing epicurve using the function
<monospace>add_incidence_fit()</monospace> (
<xref ref-type="fig" rid="f5">Figure 5</xref>).</p></sec><sec><title>Operation</title><p>The minimal system requirements for successful operation of this package is R version 3.1.</p></sec></sec><sec><title>Use cases</title><p>Two worked examples are used to demonstrate the functionality and flexibility of the
<italic>incidence</italic> package. The first example illustrates how to compute and manipulate stratified weekly incidence directly from a line-list, while the second example shows how to import pre-computed daily incidence and fit a log-linear model to estimate growth rate (
<italic>r</italic>) and doubling time for the growing phase
<xref ref-type="other" rid="FN1">1</xref>.</p><sec><title>Example 1: computing and manipulating stratified weekly incidence</title><p>In this first example, we use the dataset
<monospace>ebola_sim_clean</monospace> in the
<italic><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/outbreaks/index.html">outbreaks</ext-link></italic> package, which provides a linelist for a fictitious outbreak of Ebola Virus Disease (EVD) that matches some key epidemiological properties (e.g. serial intervals, reproduction numbers) of the West African Ebola outbreak of 2014&#x02013;2015 (
<xref rid="ref-2" ref-type="bibr">WHO Ebola Response Team
<italic>et al.</italic>, 2014</xref>).</p><p>
<bold>1) Importing data</bold>
</p><p>First, we load the dataset
<monospace>ebola_sim_clean</monospace> from the
<italic>outbreaks</italic> package. The dataset contains 5,829 cases of 9 variables, among which the date of symptom onset (
<monospace>$date_of_onset</monospace>) and the name of the hospital (
<monospace>$hospital</monospace>) are used for computing the weekly epicurves stratified by hospitals.</p><p><preformat><styled-content style="font-size:15px;color:#214A87;">library</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#4F9905;">'outbreaks'</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#000000;">dat1 &#x0003c;- ebola_sim_clean</styled-content><styled-content style="font-size:15px;color:#CF5C00;">$</styled-content><styled-content style="font-size:15px;color:#000000;">linelist</styled-content>
<styled-content style="font-size:15px;color:#214A87;">str</styled-content><styled-content style="font-size:15px;color:#000000;">(dat1,</styled-content> <styled-content style="font-size:15px;color:#214A87;">strict.width =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"cut"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">width =</styled-content> <styled-content style="font-size:15px;color:#0000CF;">76</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#000000;">## 'data.frame':      5829 obs.  of  9 variables:
##  $ case_id                   : chr  "d1fafd" "53371b" "f5c3d8" "6c286a" ...
##  $ generation                : int  0 1 1 2 2 0 3 3 2 3 ...
##  $ date_of_infection         : Date, format: NA "2014-04-09" ...
##  $ date_of_onset             : Date, format: "2014-04-07" "2014-04-15" ...
##  $ date_of_hospitalisation   : Date, format: "2014-04-17" "2014-04-20" ...
##  $ date_of_outcome           : Date, format: "2014-04-19" NA ...
##  $ outcome                   : Factor w/ 2 levels "Death","Recover": NA NA 2 ..
##  $ gender                    : Factor w/ 2 levels "f","m": 1 2 1 1 1 1 1 1 2 ..
##  $ hospital                  : Factor w/ 5 levels "Connaught Hospital",..: 2 ..</styled-content></preformat></p><p>
<bold>2) Building the incidence object</bold>
</p><p>The weekly incidence stratified by hospitals is computed by running the function
<monospace>incidence()</monospace> on the Date variable
<monospace>dat1$date_of_onset</monospace> with the arguments
<monospace>interval = 7</monospace> and
<monospace>groups = dat1$hospital</monospace>. The
<bold>incidence</bold> object
<monospace>i.7.group</monospace> is a list with class of
<bold>incidence</bold> for which several generic methods are implemented, including
<monospace>print.incidence()</monospace> and
<monospace>plot.incidence()</monospace>. Typing
<bold>incidence</bold> object
<monospace>i.7.group</monospace> implicitly calls the specific function
<monospace>print.incidence()</monospace> and prints out the summary of the data and its list components. The 5,829 cases (the total number of cases stored in the
<monospace>$n</monospace> component) with dates of symptom onset ranging from 2014-04-07 to 2015-04-27 (spanning from 2014-W15 to 2015-W18 in terms of the ISO 8601 standard for representing weeks) are used for building the
<bold>incidence</bold> object
<monospace>i.7.group</monospace>. The
<monospace>$counts</monospace> component contains the actual incidence for defined bins, which is a matrix with one column per group. Here
<monospace>$count</monospace> is a matrix with 56 rows and 6 columns as groups by hospital with 6 factor levels are specified. The bin size in number of days is stored in the
<monospace>$interval</monospace> component. In this example, 7 days suggests that weekly incidence is computed, while by default, daily incidence is computed with the argument
<monospace>interval = 1</monospace>. The
<monospace>$dates</monospace> component contains all the dates marking the left side of the bins, in the format of the input data (e.g. Date, integer, etc.). The
<monospace>$timespan</monospace> component stores the length of time (in days) for which incidence is computed. The
<monospace>$cumulative</monospace> component is a logical indication whether incidence is cumulative or not.</p><p>The generic
<monospace>plot()</monospace> method for
<bold>incidence</bold> objects calls the specific function
<monospace>plot.incidence()</monospace>, which makes an incidence barplot using the
<italic>ggplot2</italic> package. Hence, customization of
<italic>incidence</italic> plot can benefit from the powerful graphical language from
<italic>ggplot2</italic>.</p><p><preformat><styled-content style="font-size:15px;color:#214A87;">
library</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#4F9905;">'incidence'</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>
<styled-content style="font-size:15px;color:#214A87;">library</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#4F9905;">'ggplot2'</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#8F5903;"># compute weekly stratified incidence</styled-content>
<styled-content style="font-size:15px;color:#000000;">i.7.group &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">incidence</styled-content><styled-content style="font-size:15px;color:#000000;">(dat1</styled-content><styled-content style="font-size:15px;color:#CF5C00;">$</styled-content><styled-content style="font-size:15px;color:#000000;">date_of_onset,</styled-content> <styled-content style="font-size:15px;color:#214A87;">interval =</styled-content> <styled-content style="font-size:15px;color:#000000;">7,</styled-content> <styled-content style="font-size:15px;color:#214A87;">groups =</styled-content> <styled-content style="font-size:15px;color:#000000;">dat1</styled-content><styled-content style="font-size:15px;color:#CF5C00;">$</styled-content><styled-content style="font-size:15px;color:#000000;">hospital)</styled-content>
<styled-content style="font-size:15px;color:#8F5903;"># print incidence object</styled-content>
<styled-content style="font-size:15px;color:#000000;">i.7.group</styled-content>

<styled-content style="font-size:15px;color:#000000;">## &#x0003c;incidence object&#x0003e;
## [5829 cases from days 2014-04-07 to 2015-04-27]
## [5829 cases from ISO weeks 2014-W15 to 2015-W18]
## [6 groups: Connaught Hospital, Military Hospital, other,
##  Princess Christian Maternity Hospital (PCMH), Rokupa Hospital, NA]
##
## $counts: matrix with 56 rows and 6 columns
## $n: 5829 cases in total
## $dates: 56 dates marking the left-side of bins
## $interval: 7 days
## $timespan: 386 days
## $cumulative: FALSE</styled-content>

<styled-content style="font-size:15px;color:#8F5903;"># plot incidence object</styled-content>
<styled-content style="font-size:15px;color:#000000;">my_theme &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">theme_bw</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">base_size =</styled-content> <styled-content style="font-size:15px;color:#0000CF;">12</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content>
  <styled-content style="font-size:15px;color:#214A87;">theme</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">panel.grid.minor = element_blank</styled-content><styled-content style="font-size:15px;color:#000000;">())</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content>
  <styled-content style="font-size:15px;color:#214A87;">theme</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">axis.text.x = element_text</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">angle =</styled-content> <styled-content style="font-size:15px;color:#0000CF;">90</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">hjust =</styled-content> <styled-content style="font-size:15px;color:#0000CF;">1</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">vjust =</styled-content> <styled-content style="font-size:15px;color:#0000CF;">0.5</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">color =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"black"</styled-content><styled-content style="font-size:15px;color:#000000;">))</styled-content>

<styled-content style="font-size:15px;color:#214A87;">plot</styled-content><styled-content style="font-size:15px;color:#000000;">(i.7.group,</styled-content> <styled-content style="font-size:15px;color:#214A87;">border =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"white"</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content>
  <styled-content style="font-size:15px;color:#000000;">my_theme</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content>
  <styled-content style="font-size:15px;color:#214A87;">theme</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">legend.position = c</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#0000CF;">0.8</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#0000CF;">0.75</styled-content><styled-content style="font-size:15px;color:#000000;">))</styled-content></preformat></p><p>Note that when weekly incidence is computed from dates, like in this example, the ISO 8601 standard weeks are used by default with the argument
<monospace>standard = TRUE</monospace> in the
<monospace>incidence()</monospace> function. Under this situation, an extra component of
<monospace>$isoweek</monospace> is added to the
<bold>incidence</bold> object
<monospace>i.7.group</monospace> to store those weeks in the ISO 8601 standard week format &#x0201c;yyyy-Www&#x0201d;, and the
<monospace>$dates</monospace> component stores the corresponding first days of those ISO weeks. Meanwhile the x-axis tick labels of the weekly
<italic>incidence</italic> plot are in the ISO week format &#x0201c;yyyy-Www&#x0201d; (see
<xref ref-type="fig" rid="f2">Figure 2</xref>) rather than in the date format &#x0201c;yyyy-mm-dd&#x0201d; as the argument
<monospace>labels_iso_week</monospace> in the
<monospace>plot()</monospace> function is by default
<monospace>TRUE</monospace> when plotting the ISO week-based
<bold>incidence</bold> objects.</p><fig fig-type="figure" id="f2" orientation="portrait" position="anchor"><label>Figure 2. </label><caption><title>Weekly epicurves stratified by hospitals for the simulated outbreak of EVD.</title></caption><graphic xlink:href="f1000research-8-19688-g0001"/></fig><p>
<bold>3) Manipulate the incidence object</bold>
</p><p>In the above visualisation, it can be difficult to see what the dynamics were in the early stages of the epidemic. If we want to see the first 18 weeks of the outbreak in the four major hospitals, we can use the [ operator to subset the rows and columns, which represent weeks and hospitals, respectively, in this particular
<bold>incidence</bold> object.</p><p><preformat><styled-content style="font-size:15px;color:#8F5903;"># plot the first 18 weeks, defined hospitals, and use different colors</styled-content>
<styled-content style="font-size:15px;color:#000000;">i.7.sub &#x0003c;- i.7.group[</styled-content><styled-content style="font-size:15px;color:#0000CF;">1</styled-content><styled-content style="font-size:15px;color:#CF5C00;">:</styled-content><styled-content style="font-size:15px;color:#0000CF;">18</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">grep</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#4F9905;">"Hospital"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">group_names</styled-content><styled-content style="font-size:15px;color:#000000;">(1.7.group))]</styled-content>
<styled-content style="font-size:15px;color:#000000;">hosp_colors &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">c</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#4F9905;">"#899DA4"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"#C93312"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"#FAEFD1"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"#DC863B"</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>
<styled-content style="font-size:15px;color:#214A87;">plot</styled-content><styled-content style="font-size:15px;color:#000000;">(i.7.sub,</styled-content> <styled-content style="font-size:15px;color:#214A87;">show_cases =</styled-content> <styled-content style="font-size:15px;color:#8F5903;">TRUE</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">border =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"black"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">color =</styled-content> <styled-content style="font-size:15px;color:#000000;">hosp_colors)</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content>
  <styled-content style="font-size:15px;color:#000000;">my_theme</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content>
  <styled-content style="font-size:15px;color:#214A87;">theme</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">legend.position = c</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#0000CF;">0.35</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#0000CF;">0.8</styled-content><styled-content style="font-size:15px;color:#000000;">))</styled-content></preformat></p><p>Here, because of the few numbers of cases in the first few weeks, we have also highlighted each case using
<monospace>show_cases = TRUE</monospace> (
<xref ref-type="fig" rid="f3">Figure 3</xref>). We&#x02019;ve also used a different color palette to differentiate between the subsetted data and the full data set.</p><fig fig-type="figure" id="f3" orientation="portrait" position="anchor"><label>Figure 3. </label><caption><title>Weekly epicurves stratified by hospitals representing the first eight weeks of simulated outbreak of EVD.</title></caption><graphic xlink:href="f1000research-8-19688-g0002"/></fig><p>As shown in
<xref ref-type="fig" rid="f2">Figure 2</xref>, the missing hospital name (NA) is treated as a separate group, resulting from the default of the argument
<monospace>na_as_group = TRUE</monospace> in the
<monospace>incidence()</monospace> function. This argument can be set to
<monospace>FALSE</monospace> to not include data with missing groups in the object.</p></sec><sec><title>Example 2: importing pre-computed daily incidence and fitting log-linear model</title><p>The datasets
<monospace>zika_girardot_2015</monospace> and
<monospace>zika_sanandres_2015</monospace> used in the second example are also from the
<italic>outbreaks</italic> package. These datasets describe the daily incidence of Zika virus disease (ZVD) in, respectively, Girardot and San Andres Island, Colombia from September 2015 to January 2016. For details on these datasets, please refer to
<xref rid="ref-27" ref-type="bibr">Rojas
<italic>et al</italic>. (2016)</xref>.</p><p>
<bold>1) Import pre-computed daily incidence</bold>
</p><p>
<monospace>zika_girardot_2015</monospace> and
<monospace>zika_sanandres_2015</monospace> are data frames with the same variables
<monospace>date</monospace> and
<monospace>cases</monospace>. In order to obtain a more complete picture of the epidemic dynamics of ZVD in Colombia, we merge these two data.frames into a single one,
<monospace>dat2</monospace>, by variable
<monospace>date</monospace>.
<monospace>As dat2</monospace> is already pre-computed daily incidence rather than a vector of dates such as those in example 1, we can directly convert it into an
<bold>incidence</bold> object grouped by geographical locations,
<monospace>i.group</monospace>, by using the
<monospace>as.incidence()</monospace> function. This shows the flexibility of the
<italic>incidence</italic> package in making
<bold>incidence</bold> objects. Using the
<monospace>pool()</monospace> function, the daily incidence stratified by locations,
<monospace>i.group</monospace>, can be collapsed into an incidence object without groups,
<monospace>i.pooled</monospace>. The stratified and pooled daily incidence plots of ZVD in Colombia are shown in
<xref ref-type="fig" rid="f4">Figure 4</xref>, from which we can see that the epidemic of ZVD occurred earlier in San Andres Island than in Girardot.</p><p><preformat><styled-content style="font-size:15px;color:#8F5903;"># preview datasets</styled-content>
<styled-content style="font-size:15px;color:#214A87;">head</styled-content><styled-content style="font-size:15px;color:#000000;">(zika_girardot_2015,</styled-content> <styled-content style="font-size:15px;color:#0000CF;">3</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#000000;">##         date cases
## 1 2015-10-19     1
## 2 2015-10-22     2
## 3 2015-10-23     1</styled-content>

<styled-content style="font-size:15px;color:#214A87;">head</styled-content><styled-content style="font-size:15px;color:#000000;">(zika_sanandres_2015,</styled-content> <styled-content style="font-size:15px;color:#0000CF;">3</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#000000;">##         date cases
## 1 2015-09-06     1
## 2 2015-09-07     1
## 3 2015-09-08     1</styled-content>

<styled-content style="font-size:15px;color:#8F5903;"># combine two datasets into one</styled-content>
<styled-content style="font-size:15px;color:#000000;">dat2 &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">merge</styled-content><styled-content style="font-size:15px;color:#000000;">(zika_girardot_2015, zika_sanandres_2015,</styled-content> <styled-content style="font-size:15px;color:#214A87;">by =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"date"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#214A87;">all =</styled-content> <styled-content style="font-size:15px;color:#8F5903;">TRUE</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#8F5903;"># rename variables</styled-content>
<styled-content style="font-size:15px;color:#214A87;">names</styled-content><styled-content style="font-size:15px;color:#000000;">(dat2)[</styled-content><styled-content style="font-size:15px;color:#0000CF;">2</styled-content><styled-content style="font-size:15px;color:#CF5C00;">:</styled-content><styled-content style="font-size:15px;color:#0000CF;">3</styled-content><styled-content style="font-size:15px;color:#000000;">] &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">c</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#4F9905;">"Girardot"</styled-content><styled-content style="font-size:15px;color:#000000;">,</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"San Andres"</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#8F5903;"># replace NA with 0</styled-content>
<styled-content style="font-size:15px;color:#000000;">dat2[</styled-content><styled-content style="font-size:15px;color:#214A87;">is.na</styled-content><styled-content style="font-size:15px;color:#000000;">(dat2)] &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#0000CF;">0</styled-content>

<styled-content style="font-size:15px;color:#8F5903;"># convert pre-computed incidence in data.frame into incidence object</styled-content>
<styled-content style="font-size:15px;color:#8F5903;"># grouped by locations</styled-content>
<styled-content style="font-size:15px;color:#000000;">i.group &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">as.incidence</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">x =</styled-content> <styled-content style="font-size:15px;color:#000000;">dat2[,</styled-content> <styled-content style="font-size:15px;color:#0000CF;">2</styled-content><styled-content style="font-size:15px;color:#CF5C00;">:</styled-content><styled-content style="font-size:15px;color:#0000CF;">3</styled-content><styled-content style="font-size:15px;color:#000000;">],</styled-content> <styled-content style="font-size:15px;color:#214A87;">dates =</styled-content> <styled-content style="font-size:15px;color:#000000;">dat2</styled-content><styled-content style="font-size:15px;color:#CF5C00;">$</styled-content><styled-content style="font-size:15px;color:#000000;">date)</styled-content>

<styled-content style="font-size:15px;color:#8F5903;"># pool incidence across two locations</styled-content>
<styled-content style="font-size:15px;color:#000000;">i.pooled &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">pool</styled-content><styled-content style="font-size:15px;color:#000000;">(i.group)</styled-content>
<styled-content style="font-size:15px;color:#214A87;">plot</styled-content><styled-content style="font-size:15px;color:#000000;">(i.group,</styled-content> <styled-content style="font-size:15px;color:#214A87;">border =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"white"</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>  <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content> <styled-content style="font-size:15px;color:#000000;">my_theme</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content> <styled-content style="font-size:15px;color:#214A87;">theme</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#214A87;">legend.position = c</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#0000CF;">0.9</styled-content>, <styled-content style="font-size:15px;color:#0000CF;">0.7</styled-content><styled-content style="font-size:15px;color:#000000;">))</styled-content>
<styled-content style="font-size:15px;color:#214A87;">plot</styled-content><styled-content style="font-size:15px;color:#000000;">(i.pooled,</styled-content> <styled-content style="font-size:15px;color:#214A87;">border =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"white"</styled-content>) <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content> <styled-content style="font-size:15px;color:#000000;">my_theme</styled-content></preformat></p><fig fig-type="figure" id="f4" orientation="portrait" position="anchor"><label>Figure 4. </label><caption><p>(
<bold>A</bold>) stratified and (
<bold>B</bold>) pooled daily incidence plots of ZVD in Colombia, September 2015 to January 2016.</p></caption><graphic xlink:href="f1000research-8-19688-g0003"/></fig><p>As shown in
<xref ref-type="fig" rid="f4">Figure 4B</xref>, the pooled daily incidence in Colombia shows approximately exponential phases before and after the epidemic peak. Therefore, we fit two log-linear regression models around the peak to characterize the epidemic dynamics of ZVD in Colombia. Such models can be separately fitted to the two phases of the epicurve of
<monospace>i.pooled</monospace> using the
<monospace>fit()</monospace> function, which, however, requires us to know what date should be used to split the epicurve in two phases (see the argument
<monospace>split</monospace> in the
<monospace>fit()</monospace> function). Without any knowledge on the splitting date, we can turn to the
<monospace>fit_optim_split()</monospace> function to look for the optimal splitting date (i.e. the one maximizing the average fit of both models) and then fit two log-linear regression models before and after the optimal splitting date.</p><p><preformat><styled-content style="font-size:15px;color:#214A87;">library</styled-content><styled-content style="font-size:15px;color:#000000;">(</styled-content><styled-content style="font-size:15px;color:#4F9905;">'magrittr'</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content>

<styled-content style="font-size:15px;color:#000000;">fos &#x0003c;-</styled-content> <styled-content style="font-size:15px;color:#214A87;">fit_optim_split</styled-content><styled-content style="font-size:15px;color:#000000;">(i.pooled)</styled-content>
<styled-content style="font-size:15px;color:#000000;">fos</styled-content><styled-content style="font-size:15px;color:#CF5C00;">$</styled-content><styled-content style="font-size:15px;color:#000000;">split</styled-content>

<styled-content style="font-size:15px;color:#000000;">## [1] "2015-11-15"</styled-content>

<styled-content style="font-size:15px;color:#000000;">fos</styled-content><styled-content style="font-size:15px;color:#CF5C00;">$</styled-content><styled-content style="font-size:15px;color:#000000;">fit</styled-content>

<styled-content style="font-size:15px;color:#000000;">## &#x0003c;list of incidence_fit objects&#x0003e;
##
## attr(x, 'locations'): list of vectors with the locations of each incidence_fit object
##
## 'before'
## 'after'
##
## $model: regression of log-incidence over time
##
## $info: list containing the following items:
##   $r (daily growth rate):
##      before       after
##  0.06659200 -0.04813045
##
##   $r.conf (confidence interval):
##              2.5 %      97.5 %
## before  0.05869968  0.07448432
## after  -0.05440018 -0.04186071
##
##   $doubling (doubling time in days):
##   before
## 10.40887
##
##   $doubling.conf (confidence interval):
##           2.5 %   97.5 %
## before 9.305948 11.80836
##
##   $halving (halving time in days):
##    after
## 14.40143
##
##   $halving.conf (confidence interval):
##          2.5 %   97.5 %
## after 12.74163 16.55842
##
##   $pred: data.frame of incidence predictions (129 rows, 6 columns)</styled-content>

<styled-content style="font-size:15px;color:#214A87;">plot</styled-content><styled-content style="font-size:15px;color:#000000;">(i.pooled,</styled-content> <styled-content style="font-size:15px;color:#214A87;">border =</styled-content> <styled-content style="font-size:15px;color:#4F9905;">"white"</styled-content><styled-content style="font-size:15px;color:#000000;">)</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">%&#x0003e;%</styled-content>
  <styled-content style="font-size:15px;color:#214A87;">add_incidence_fit</styled-content><styled-content style="font-size:15px;color:#000000;">(fos</styled-content><styled-content style="font-size:15px;color:#CF5C00;">$</styled-content><styled-content style="font-size:15px;color:#000000;">fit)</styled-content> <styled-content style="font-size:15px;color:#CF5C00;">+</styled-content>
  <styled-content style="font-size:15px;color:#000000;">my_theme</styled-content></preformat></p><p>The returned object
<monospace>fos</monospace> is a list with 4 components. The
<monospace>$split</monospace> component suggests that the optimal splitting date is 2015-11-15. The
<monospace>$fit</monospace> component is an
<bold>incidence_fit_list</bold> containing two
<bold>incidence_fit</bold> objects named &#x02018;before&#x02019; and &#x02018;after&#x02019;. These each contain the information extracted from the fitted log-linear regression models. Printing the
<monospace>$fit</monospace> component shows a daily growth rate
<italic>r</italic> of 0.067 and its 95% confidence interval (CI) ([0.059, 0.074]), and a doubling time of 10.4 days (95% CI, [9.31, 11.8]) during the first phase, and a daily decreasing rate
<italic>r</italic> of -0.048 (95% CI, [-0.054, -0.042]), and a halving time of 14.4 days (95% CI, [12.7, 16.6]) during the second.</p><p>The predictions and their 95% CIs from the two
<bold>incidence_fit</bold> objects, &#x02018;before&#x02019; and &#x02018;after&#x02019;, can be added to the existing incidence plot of
<monospace>i.pooled</monospace> using the piping-friendly function
<monospace>add_incidence_fit()</monospace>. As shown in
<xref ref-type="fig" rid="f5">Figure 5</xref>, based on visual comparison of models and data, these two log-linear regression models provide a decent approximation for the actual dynamics of the epidemic (adjusted
<italic>R</italic>
<sup>2</sup> = 0.83 and 0.77 for the increasing and decreasing phases, respectively).</p><fig fig-type="figure" id="f5" orientation="portrait" position="anchor"><label>Figure 5. </label><caption><title>Fit two log-linear regression models, before and after the optimal splitting date.</title></caption><graphic xlink:href="f1000research-8-19688-g0004"/></fig></sec></sec><sec sec-type="conclusions"><title>Conclusion</title><p>This article has described the package
<italic>incidence</italic> and its features&#x02014;which include three lightweight data classes and utilities for data manipulation, plotting, and modeling. We have shown that an
<bold>incidence</bold> object can flexibly be defined at different datetime intervals with any number of stratifications and be subset by groups or dates. The most important aspects of this package are use-ability and interoperability. For both field epidemiologists and academic modellers, the data received are often in the form of line-lists where each row represents a single case. We have shown that these data can easily be converted to an
<bold>incidence</bold> object and then plotted with sensible defaults in two lines of code.</p><p>We have additionally shown that because the data are aggregated into a matrix of counts, it becomes simple to perform operations related to peak-finding, model-fitting, and exportation (e.g. using
<monospace>as.data.frame()</monospace>) into different formats. Thus, because it has built-in tools for aggregation, visualisation, and model fitting, the
<italic>incidence</italic> package is ideal for rapid generation of reports and estimates in outbreak response situations where time is a critical factor.</p></sec><sec><title>Software availability</title><p>
<italic>incidence</italic> available from:
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/incidence/">https://www.repidemicsconsortium.org/incidence</ext-link> Code to reproduce all figures can be found by running
<monospace>demo ("incidence-demo", package = "incidence")</monospace> from the R console with the incidence package installed.</p><p>Source code available from:
<ext-link ext-link-type="uri" xlink:href="https://github.com/reconhub/incidence">https://github.com/reconhub/incidence</ext-link>
</p><p>Archived source code as at time of publication:
<ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.5281/zenodo.2540217">https://doi.org/10.5281/zenodo.2540217</ext-link> (
<xref rid="ref-28" ref-type="bibr">Jombart
<italic>et al</italic>., 2019</xref>)</p><p>Software license: MIT</p></sec><sec sec-type="data-availability"><title>Data availability</title><sec><title>Underlying data</title><p>Datasets used in the worked examples are from the
<italic><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/outbreaks/index.html">outbreaks</ext-link></italic> package:</p><p>ebola_sim_clean:
<ext-link ext-link-type="uri" xlink:href="https://github.com/reconhub/outbreaks/blob/master/data/ebola_sim_clean.RData">https://github.com/reconhub/outbreaks/blob/master/data/ebola_ sim_clean.RData</ext-link>
</p><p>zika_girardot_2015:
<ext-link ext-link-type="uri" xlink:href="https://github.com/reconhub/outbreaks/blob/master/data/zika_girardot_2015.RData">https://github.com/reconhub/outbreaks/blob/master/data/zika_ girardot_2015.RData</ext-link>
</p><p>zika_sanandres_2015:
<ext-link ext-link-type="uri" xlink:href="https://github.com/reconhub/outbreaks/blob/master/data/zika_sanandres_2015.RData">https://github.com/reconhub/outbreaks/blob/master/data/zika_sanandres_2015.RData</ext-link>
</p></sec></sec></body><back><ack><title>Acknowledgments</title><p>We would like to thank Michael H&#x000f6;hle for discussion about the caveats for
<monospace>estimate_peak()</monospace>, the R developer community for constantly improving our working environment,
<ext-link ext-link-type="uri" xlink:href="https://github.com/">github</ext-link> for hosting our project,
<ext-link ext-link-type="uri" xlink:href="https://travis-ci.org/">travis</ext-link>,
<ext-link ext-link-type="uri" xlink:href="https://www.appveyor.com/">appveyor</ext-link> and
<ext-link ext-link-type="uri" xlink:href="https://codecov.io/">codecov</ext-link> for providing free continuous integration resources, and the
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/">RECON community</ext-link>.</p></ack><fn-group><fn id="FN1"><label>1</label><p>Negative values of
<italic>r</italic> in incidence are reported as halving times instead of doubling times and decreasing phase instead of growing phase</p></fn></fn-group><ref-list><ref id="ref-8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Barrett</surname><given-names>P</given-names></name><name><surname>Chaintarli</surname><given-names>K</given-names></name><name><surname>Ryan</surname><given-names>F</given-names></name><etal/></person-group>:
<article-title>An ongoing measles outbreak linked to a suspected imported case, Ireland, April to June 2016.</article-title>
<source><italic>Euro Surveill.</italic></source>
<year>2016</year>;<volume>21</volume>(<issue>27</issue>).
<pub-id pub-id-type="doi">10.2807/1560-7917.ES.2016.21.27.30277</pub-id>
<?supplied-pmid 27416848?><pub-id pub-id-type="pmid">27416848</pub-id></mixed-citation></ref><ref id="ref-4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Cori</surname><given-names>A</given-names></name><name><surname>Donnelly</surname><given-names>CA</given-names></name><name><surname>Dorigatti</surname><given-names>I</given-names></name><etal/></person-group>:
<article-title>Key data for outbreak evaluation: building on the Ebola experience.</article-title>
<source><italic>Philos Trans R Soc Lond B Biol Sci.</italic></source>
<year>2017</year>;<volume>372</volume>(<issue>1721</issue>): pii: 20160371.
<pub-id pub-id-type="doi">10.1098/rstb.2016.0371</pub-id>
<!--<pub-id pub-id-type="pmcid">5394647</pub-id>-->
<?supplied-pmid 28396480?><pub-id pub-id-type="pmid">28396480</pub-id></mixed-citation></ref><ref id="ref-12"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Cori</surname><given-names>A</given-names></name><name><surname>Ferguson</surname><given-names>NM</given-names></name><name><surname>Fraser</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>A new framework and software to estimate time-varying reproduction numbers during epidemics.</article-title>
<source><italic>Am J Epidemiol.</italic></source>
<year>2013</year>;<volume>178</volume>(<issue>9</issue>):<fpage>1505</fpage>&#x02013;<lpage>1512</lpage>.
<pub-id pub-id-type="doi">10.1093/aje/kwt133</pub-id>
<!--<pub-id pub-id-type="pmcid">3816335</pub-id>-->
<?supplied-pmid 24043437?><pub-id pub-id-type="pmid">24043437</pub-id></mixed-citation></ref><ref id="ref-16"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Farrington</surname><given-names>P</given-names></name><name><surname>Andrews</surname><given-names>N</given-names></name></person-group>:
<article-title>
<italic>Outbreak detection</italic>: Application to infectious disease surveillance</article-title>. In
<italic>Monitoring the Health of Populations.</italic>Oxford University Press, New York.<year>2003</year>
<pub-id pub-id-type="doi">10.1093/acprof:oso/9780195146493.001.0001</pub-id>
</mixed-citation></ref><ref id="ref-7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Fitzgerald</surname><given-names>M</given-names></name><name><surname>Thornton</surname><given-names>L</given-names></name><name><surname>O'Gorman</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Outbreak of hepatitis A infection associated with the consumption of frozen berries, Ireland, 2013--linked to an international outbreak.</article-title>
<source><italic>Euro Surveill.</italic></source>
<year>2014</year>;<volume>19</volume>(<issue>43</issue>): pii: 20942.
<pub-id pub-id-type="doi">10.2807/1560-7917.es2014.19.43.20942</pub-id>
<?supplied-pmid 25375902?><pub-id pub-id-type="pmid">25375902</pub-id></mixed-citation></ref><ref id="ref-1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Fraser</surname><given-names>C</given-names></name><name><surname>Donnelly</surname><given-names>CA</given-names></name><name><surname>Cauchemez</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Pandemic potential of a strain of influenza A (H1N1): early findings.</article-title>
<source><italic>Science.</italic></source>
<year>2009</year>;<volume>324</volume>(<issue>5934</issue>):<fpage>1557</fpage>&#x02013;<lpage>1561</lpage>.
<pub-id pub-id-type="doi">10.1126/science.1176062</pub-id>
<!--<pub-id pub-id-type="pmcid">3735127</pub-id>-->
<?supplied-pmid 19433588?><pub-id pub-id-type="pmid">19433588</pub-id></mixed-citation></ref><ref id="ref-13"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Funk</surname><given-names>S</given-names></name><name><surname>Camacho</surname><given-names>A</given-names></name><name><surname>Kucharski</surname><given-names>AJ</given-names></name><etal/></person-group>:
<article-title>Real-time forecasting of infectious disease dynamics with a stochastic semi-mechanistic model.</article-title>
<source><italic>Epidemics.</italic></source>
<year>2018</year>;<volume>22</volume>:<fpage>56</fpage>&#x02013;<lpage>61</lpage>.
<pub-id pub-id-type="doi">10.1016/j.epidem.2016.11.003</pub-id>
<!--<pub-id pub-id-type="pmcid">5871642 </pub-id>-->
<?supplied-pmid 28038870?><pub-id pub-id-type="pmid">28038870</pub-id></mixed-citation></ref><ref id="ref-5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Gire</surname><given-names>SK</given-names></name><name><surname>Goba</surname><given-names>A</given-names></name><name><surname>Andersen</surname><given-names>KG</given-names></name><etal/></person-group>:
<article-title>Genomic surveillance elucidates Ebola virus origin and transmission during the 2014 outbreak.</article-title>
<source><italic>Science.</italic></source>
<year>2014</year>;<volume>345</volume>(<issue>6202</issue>):<fpage>1369</fpage>&#x02013;<lpage>1372</lpage>.
<pub-id pub-id-type="doi">10.1126/science.1259657</pub-id>
<!--<pub-id pub-id-type="pmcid">4431643</pub-id>-->
<?supplied-pmid 25214632?><pub-id pub-id-type="pmid">25214632</pub-id></mixed-citation></ref><ref id="ref-24"><mixed-citation publication-type="web">
<person-group person-group-type="author"><name><surname>Henry</surname><given-names>L</given-names></name><name><surname>Sutherland</surname><given-names>C</given-names></name><name><surname>Hong</surname><given-names>D</given-names></name></person-group>:
<article-title>vdiffr: Visual regression testing and graphical diffing</article-title>.<year>2018</year>
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/vdiffr/index.html">Reference Source</ext-link>
</mixed-citation></ref><ref id="ref-21"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>H&#x000f6;hle</surname><given-names>M</given-names></name></person-group>:
<article-title>surveillance: An R package for the monitoring of infectious diseases.</article-title>
<source><italic>Comput Stat.</italic></source>
<year>2007</year>;<volume>22</volume>(<issue>4</issue>):<fpage>571</fpage>&#x02013;<lpage>582</lpage>.
<pub-id pub-id-type="doi">10.1007/s00180-007-0074-8</pub-id>
</mixed-citation></ref><ref id="ref-10"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Jernberg</surname><given-names>C</given-names></name><name><surname>Hjertqvist</surname><given-names>M</given-names></name><name><surname>Sundborger</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>Outbreak of Salmonella Enteritidis phage type 13a infection in Sweden linked to imported dried-vegetable spice mixes, December 2014 to July 2015.</article-title>
<source><italic>Euro Surveill.</italic></source>
<year>2015</year>;<volume>20</volume>(<issue>30</issue>): pii: 21194.
<pub-id pub-id-type="doi">10.2807/1560-7917.es2015.20.30.21194</pub-id>
<?supplied-pmid 26250070?><pub-id pub-id-type="pmid">26250070</pub-id></mixed-citation></ref><ref id="ref-19"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Jombart</surname><given-names>T</given-names></name><name><surname>Aanensen</surname><given-names>DM</given-names></name><name><surname>Baguelin</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>OutbreakTools: a new platform for disease outbreak analysis using the R software.</article-title>
<source><italic>Epidemics.</italic></source>
<year>2014</year>;<volume>7</volume>(<issue>0</issue>):<fpage>28</fpage>&#x02013;<lpage>34</lpage>.
<pub-id pub-id-type="doi">10.1016/j.epidem.2014.04.003</pub-id>
<!--<pub-id pub-id-type="pmcid">4058532</pub-id>-->
<?supplied-pmid 24928667?><pub-id pub-id-type="pmid">24928667</pub-id></mixed-citation></ref><ref id="ref-28"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Jombart</surname><given-names>T</given-names></name><name><surname>Kamvar</surname><given-names>ZN</given-names></name><name><surname>Cai</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>reconhub/incidence 1.5 (Version 1.5).</article-title>
<source><italic>Zenodo.</italic></source>
<year>2019</year>
<pub-id pub-id-type="doi">10.5281/zenodo.2540217</pub-id>
</mixed-citation></ref><ref id="ref-9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Lanini</surname><given-names>S</given-names></name><name><surname>Capobianchi</surname><given-names>MR</given-names></name><name><surname>Puro</surname><given-names>V</given-names></name><etal/></person-group>:
<article-title>Measles outbreak on a cruise ship in the western Mediterranean, February 2014, preliminary report.</article-title>
<source><italic>Euro Surveill.</italic></source>
<year>2014</year>;<volume>19</volume>(<issue>10</issue>): pii: 20735.
<pub-id pub-id-type="doi">10.2807/1560-7917.es2014.19.10.20735</pub-id>
<?supplied-pmid 24650863?><pub-id pub-id-type="pmid">24650863</pub-id></mixed-citation></ref><ref id="ref-11"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Meltzer</surname><given-names>MI</given-names></name><name><surname>Atkins</surname><given-names>CY</given-names></name><name><surname>Santibanez</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Estimating the future number of cases in the Ebola epidemic--Liberia and Sierra Leone, 2014-2015.</article-title>
<source><italic>MMWR Suppl.</italic></source>
<year>2014</year>;<volume>63</volume>(<issue>3</issue>):<fpage>1</fpage>&#x02013;<lpage>14</lpage>.
<?supplied-pmid 25254986?><pub-id pub-id-type="pmid">25254986</pub-id></mixed-citation></ref><ref id="ref-6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Nhan</surname><given-names>LNT</given-names></name><name><surname>Hong</surname><given-names>NTT</given-names></name><name><surname>Nhu</surname><given-names>LNT</given-names></name><etal/></person-group>:
<article-title>Severe enterovirus A71 associated hand, foot and mouth disease, Vietnam, 2018: preliminary report of an impending outbreak.</article-title>
<source><italic>Euro Surveill.</italic></source>
<year>2018</year>;<volume>23</volume>(<issue>46</issue>): 1800590.
<pub-id pub-id-type="doi">10.2807/1560-7917.ES.2018.23.46.1800590</pub-id>
<!--<pub-id pub-id-type="pmcid">6247458</pub-id>-->
<?supplied-pmid 30458911?><pub-id pub-id-type="pmid">30458911</pub-id></mixed-citation></ref><ref id="ref-14"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Nouvellet</surname><given-names>P</given-names></name><name><surname>Cori</surname><given-names>A</given-names></name><name><surname>Garske</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>A simple approach to measure transmissibility and forecast incidence.</article-title>
<source><italic>Epidemics.</italic></source>
<year>2018</year>;<volume>22</volume>:<fpage>29</fpage>&#x02013;<lpage>35</lpage>.
<pub-id pub-id-type="doi">10.1016/j.epidem.2017.02.012</pub-id>
<!--<pub-id pub-id-type="pmcid">5871640</pub-id>-->
<?supplied-pmid 28351674?><pub-id pub-id-type="pmid">28351674</pub-id></mixed-citation></ref><ref id="ref-18"><mixed-citation publication-type="web">
<collab>R Core Team</collab>:
<article-title>R: A language and environment for statistical computing</article-title>.<year>2017</year>
<ext-link ext-link-type="uri" xlink:href="https://www.researchgate.net/publication/318393712_R_A_Language_and_Environment_for_Statistical_Computing">Reference Source</ext-link>
</mixed-citation></ref><ref id="ref-27"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Rojas</surname><given-names>DP</given-names></name><name><surname>Dean</surname><given-names>NE</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><etal/></person-group>:
<article-title>The epidemiology and transmissibility of zika virus in girardot and san andres island, colombia, september 2015 to january 2016.</article-title>
<source><italic>Euro Surveill.</italic></source>
<year>2016</year>;<volume>21</volume>(<issue>28</issue>).
<pub-id pub-id-type="doi">10.2807/1560-7917.ES.2016.21.28.30283</pub-id>
<!--<pub-id pub-id-type="pmcid">5124348</pub-id>-->
<?supplied-pmid 27452806?><pub-id pub-id-type="pmid">27452806</pub-id></mixed-citation></ref><ref id="ref-20"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Shumway</surname><given-names>RH</given-names></name><name><surname>Stoffer</surname><given-names>DS</given-names></name></person-group>:
<article-title>Time Series Analysis and Its Applications: With R Examples</article-title>. Springer Science &#x00026; Business Media,<year>2010</year>
<ext-link ext-link-type="uri" xlink:href="https://www.stat.pitt.edu/stoffer/tsa4/tsa4.pdf">Reference Source</ext-link>
</mixed-citation></ref><ref id="ref-17"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Unkel</surname><given-names>S</given-names></name><name><surname>Farrington</surname><given-names>CP</given-names></name><name><surname>Garthwaite</surname><given-names>PH</given-names></name><etal/></person-group>:
<article-title>Statistical methods for the prospective detection of infectious disease outbreaks: a review.</article-title>
<source><italic>J R Stat Soc Ser A Stat Soc.</italic></source>
<year>2012</year>;<volume>175</volume>(<issue>1</issue>):<fpage>49</fpage>&#x02013;<lpage>82</lpage>.
<pub-id pub-id-type="doi">10.1111/j.1467-985X.2011.00714.x</pub-id>
</mixed-citation></ref><ref id="ref-15"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Viboud</surname><given-names>C</given-names></name><name><surname>Sun</surname><given-names>K</given-names></name><name><surname>Gaffey</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>The RAPIDD ebola forecasting challenge: Synthesis and lessons learnt.</article-title>
<source><italic>Epidemics.</italic></source>
<year>2018</year>;<volume>22</volume>:<fpage>13</fpage>&#x02013;<lpage>21</lpage>.
<pub-id pub-id-type="doi">10.1016/j.epidem.2017.08.002</pub-id>
<!--<pub-id pub-id-type="pmcid">5927600</pub-id>-->
<?supplied-pmid 28958414?><pub-id pub-id-type="pmid">28958414</pub-id></mixed-citation></ref><ref id="ref-26"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wallinga</surname><given-names>J</given-names></name><name><surname>Lipsitch</surname><given-names>M</given-names></name></person-group>:
<article-title>How generation intervals shape the relationship between growth rates and reproductive numbers.</article-title>
<source><italic>Proc Biol Sci.</italic></source>
<year>2007</year>;<volume>274</volume>(<issue>1609</issue>):<fpage>599</fpage>&#x02013;<lpage>604</lpage>.
<pub-id pub-id-type="doi">10.1098/rspb.2006.3754</pub-id>
<!--<pub-id pub-id-type="pmcid">1766383</pub-id>-->
<?supplied-pmid 17476782?><pub-id pub-id-type="pmid">17476782</pub-id></mixed-citation></ref><ref id="ref-25"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wallinga</surname><given-names>J</given-names></name><name><surname>Teunis</surname><given-names>P</given-names></name></person-group>:
<article-title>Different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures.</article-title>
<source><italic>Am J Epidemiol.</italic></source>
<year>2004</year>;<volume>160</volume>(<issue>6</issue>):<fpage>509</fpage>&#x02013;<lpage>516</lpage>.
<pub-id pub-id-type="doi">10.1093/aje/kwh255</pub-id>
<?supplied-pmid 15353409?><pub-id pub-id-type="pmid">15353409</pub-id></mixed-citation></ref><ref id="ref-22"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name></person-group>:
<article-title>ggplot2: elegant graphics for data analysis</article-title>. UseR! Springer.<year>2016</year>
<ext-link ext-link-type="uri" xlink:href="http://moderngraphics11.pbworks.com/f/ggplot2-Book09hWickham.pdf">Reference Source</ext-link>
</mixed-citation></ref><ref id="ref-23"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name></person-group>:
<article-title>testthat: Get started with testing.</article-title>
<source><italic>R J.</italic></source>
<year>2011</year>;<volume>3</volume>(<issue>1</issue>):<fpage>5</fpage>&#x02013;<lpage>10</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://journal.r-project.org/archive/2011/RJ-2011-002/RJ-2011-002.pdf">Reference Source</ext-link>
</mixed-citation></ref><ref id="ref-2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><collab>WHO Ebola Response Team, </collab><name><surname>Aylward</surname><given-names>B</given-names></name><name><surname>Barboza</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Ebola virus disease in West Africa--the first 9 months of the epidemic and forward projections.</article-title>
<source><italic>N Engl J Med.</italic></source>
<year>2014</year>;<volume>371</volume>(<issue>16</issue>):<fpage>1481</fpage>&#x02013;<lpage>1495</lpage>.
<pub-id pub-id-type="doi">10.1056/NEJMoa1411100</pub-id>
<!--<pub-id pub-id-type="pmcid">4235004</pub-id>-->
<?supplied-pmid 25244186?><pub-id pub-id-type="pmid">25244186</pub-id></mixed-citation></ref><ref id="ref-3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><collab>WHO Ebola Response Team, </collab><name><surname>Agua-Agum</surname><given-names>J</given-names></name><name><surname>Ariyarajah</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>West African Ebola epidemic after one year--slowing but not yet under control.</article-title>
<source><italic>N Engl J Med.</italic></source>
<year>2015</year>;<volume>372</volume>(<issue>6</issue>):<fpage>584</fpage>&#x02013;<lpage>587</lpage>.
<pub-id pub-id-type="doi">10.1056/NEJMc1414992</pub-id>
<!--<pub-id pub-id-type="pmcid">4368109</pub-id>-->
<?supplied-pmid 25539446?><pub-id pub-id-type="pmid">25539446</pub-id></mixed-citation></ref></ref-list></back><sub-article id="report48153" article-type="peer-review"><front-stub><article-id pub-id-type="doi">10.5256/f1000research.19688.r48153</article-id><title-group><article-title>Reviewer response for version 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Sudre</surname><given-names>Bertrand</given-names></name><xref ref-type="aff" rid="r48153a1">1</xref><role>Referee</role></contrib><aff id="r48153a1">
<label>1</label>European Centre for Disease Prevention and Control (ECDC), Solna, Sweden</aff></contrib-group><author-notes><fn fn-type="COI-statement"><p>
<bold>Competing interests: </bold>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>7</day><month>5</month><year>2019</year></pub-date><related-article related-article-type="peer-reviewed-article" id="d35e3044" ext-link-type="doi" xlink:href="10.12688/f1000research.18002.1">Version 1</related-article><custom-meta-group><custom-meta><meta-name>recommendation</meta-name><meta-value>approve-with-reservations</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<underline><bold>Major comments</bold></underline>
</p><p> The proposed package is addressing some of the topmost descriptive elements of any epidemiological data set, namely a systematic time-place-person description. With regards to epidemiological curves, a limited number of dedicated packages addressing these aspects were available at the time of this package release (mainly: epitools,&#x000a0;
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/epitools/epitools.pdf">https://cran.r-project.org/web/packages/epitools/epitools.pdf</ext-link>&#x000a0; [last update: October 26, 2017] and EpiCurve,
<ext-link ext-link-type="uri" xlink:href="https://cran.rstudio.com/web/packages/EpiCurve/EpiCurve.pdf">https://cran.rstudio.com/web/packages/EpiCurve/EpiCurve.pdf</ext-link> [last update:&#x000a0;April 24, 2018]). The alternative was a tailor-made, and time consuming, customization based on existing dedicated packages (for instance using customized
<ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org/reference/geom_bar.html">bar charts</ext-link> geoms from ggplot2). While the data storage and representation is well addressed by the authors, the proposed package offers: i) some basic utilities for outbreak description across time, ii) basic tool for outbreak modelling and iii) a standard for data storage to enhance interoperability between released projects and packages from the
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/projects/">R epidemic consortium</ext-link>. In the introduction a short overview of the alternative tools mentioned above should be provided to the reader, together with the new added-values of the current package. It would be an asset in order to ensure a benchmarking analysis with pre-existing resources.</p><p> &#x0201c;Here, we introduce
<italic><underline>incidence</underline></italic>, an R package developed as part of the toolbox for epidemics analysis of the R Epidemics Consortium (RECON) which aims to fill this gap. In this paper, we outline the package&#x02019;s design and illustrate its functionalities using a reproducible worked example.&#x0201d;</p><p> According to RECON website: package incidence corresponds to &#x0201c;Computation, handling, visualisation and simple modelling of incidence&#x0201d;. It is honourable that the name of a package &#x0201c;incidence&#x0201d; is the choice of the creators of course. It is true that incident cases are all individuals who change to non-disease status from disease, so in this way &#x0201c;incidence&#x0201d; could refer to the occurrence of new cases. In recent modelling papers, the term incidence has been associated to count time series under the same approach, so-called &#x0201c;incidence time series&#x0201d;
<sup><xref rid="rep-ref-48153-1" ref-type="bibr">1</xref></sup>.</p><p> Nevertheless, the current name can be misleading for a certain number of epidemiologists. The reason is that in epidemiology the term incidence is traditionally associated to a measure of morbidity, so-called 'Incidence proportion' (or attack rate or risk; for more information see:
<ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/csels/dsepd/ss1978/lesson3/section2.html">https://www.cdc.gov/ophss/csels/dsepd/ss1978/lesson3/section2.html</ext-link>). The latter comprised the numerator (= count of case used for a raw epi-curve) but as well a denominator representing the population at risk during the selected time interval. At the first glance, the target audience reading the package name might believe that the package is dedicated to incidence calculation rather than epidemiological curve graphic representation and some basic modelling utilities. Indeed, the package is presented as being able to compute, handle and visualize time-related count data through epi-curve and additional derived features which are not related to measure of incidence (proportion) strictly speaking.</p><p> You may wish to consider adding such features and include new capabilities to this package which can cover calculation/representation of incidence in epidemiology. For instance, adding a slot for population data to populate the denominator of an incidence proportion calculation. This can be completed by dedicated graphic outputs with points for each incidence values and line through all data points (geom line). Factor-specific incidence rate (and corresponding CI) can be considered as further extensions (factor: sex-, age-, or any other factor). The advantage is the possibility to overlay and compare several incidence line charts coming for different locations (e.g. attack rate for different health districts or for several population group). It is a suggestion and it is acceptable that the authors would keep the package focus on basic utilities and epicurve representation.</p><p> With regards to the structure of the article, it would be easier to start with an example based on simple line listing (see comment on figure 1) with simple epicurve without stratification (with different timing hour, day. week), then move to more complex representation (stratification with various colour in the legend; +/- facetting), and then an example of tailor-made polished figure (see code below). In doing so the figure 1 which would start for a line-list format would be easier to understand.</p><p>
<bold><underline>Minor comments</underline></bold>
</p><p>
<bold>Section: </bold>
<bold>Author&#x02019;s affiliation </bold>
</p><p> Comment 1:
<list list-type="bullet"><list-item><p>&#x0201c;Department of Infectious Disease Epidemiolog
<underline>y </underline>, School of Public Health, Imperial" - Space to remove after epidemiology</p></list-item><list-item><p>&#x0201c;Epidemiological Modelling and Analysis (SACEMA
<underline>),, </underline>Stellenbosch University, Stellenbosch&#x0201d; - Double coma to remove</p></list-item></list>
<bold>Section: Introduction</bold>
</p><p> Comment 2:
<list list-type="bullet"><list-item><p>&#x0201c;Responses to infectious disease epidemics use a growing body of data sources to inform decision making (Cori
<italic>et al</italic>., 2017; Fraser
<italic>et al</italic>., 2009; WHO Ebola Response Team
<italic>et al</italic>., 2014; WHO Ebola Response Team
<italic>et al</italic>., 2015). While new data&#x02014;such as whole genome pathogen sequences&#x02014;are increasingly useful complements to epidemiological data (Gire
<italic>et al</italic>., 2014), epidemic curves&#x02014;which describe the number of new cases through time (incidence)&#x02014;remain the most important source of information, particularly early in an outbreak.&#x0201d; - Rephrase avoiding four "&#x02014;" in the same sentence.</p></list-item></list> Partial genome sequencing is useful to complement epidata/infect. disease epi. If you wish to highlight the WGS/extensive sequencing, consider several aspects:
<list list-type="bullet"><list-item><p>Confirm change in infectiousness or epidemiology (CFR, change in clinical presentation, shift in risk group.)</p></list-item><list-item><p>Relationships between cases (mapping Lassa, Ebola transmission chains ...)</p></list-item><list-item><p>Emergence and patterns of transmission (vector, host, reservoir)</p></list-item></list> Suggested examples from the recent literature:
<list list-type="bullet"><list-item><p>Kraemer MUG, Cummings DAT, Funk S, Reiner RC, Faria NR, Pybus OG, Cauchemez S. Reconstruction and prediction of viral disease epidemics. Epidemiol Infect. 2018&#x000a0; Nov 5:1-7. doi: 10.1017/S0950268818002881. [Epub ahead of print] PubMed PMID: 30394230; PubMed Central PMCID: PMC6398585.
<sup><xref rid="rep-ref-48153-2" ref-type="bibr">2</xref></sup>&#x000a0; &#x000a0; &#x000a0; &#x000a0; &#x000a0; &#x000a0; &#x000a0; &#x000a0;</p></list-item><list-item><p>Siddle KJ
<italic>et al</italic>.&#x000a0;Genomic Analysis of Lassa Virus during an Increase in Cases in Nigeria in 2018. N Engl J Med. 2018 Nov.
<sup><xref rid="rep-ref-48153-3" ref-type="bibr">3</xref></sup>&#x000a0;</p></list-item><list-item><p>Kafetzopoulou LE
<italic>et al</italic>, Metagenomic sequencing at the epicenter of the Nigeria 2018 Lassa fever outbreak. Science. 2019 Jan 4;363(6422):74-77.
<sup><xref rid="rep-ref-48153-4" ref-type="bibr">4</xref></sup>
</p></list-item></list> Comment 3:
<list list-type="bullet"><list-item><p>&#x0201c;which describe the number of new cases through time (incidence)&#x02014;remain&#x0201d; -Proposed change of 'through' to 'over'</p></list-item></list> Comment 4:
<list list-type="bullet"><list-item><p>&#x0201c;important source of information, particularly early in an outbreak.&#x0201d; - Not only. This can be helpful to look at the magnitude and pattern (recurrent environmental sources, detect outliers ...).</p></list-item></list> Comment 5:
<list list-type="bullet"><list-item><p>&#x0201c;Specifically epidemic curves(often&#x0201d; - Missing space.</p></list-item></list> Comment 6:
<list list-type="bullet"><list-item><p>&#x0201c;[&#x02026;] often referred to as &#x02018;epicurves&#x02019;) represent the number of new cases [&#x02026;]&#x0201d; - New cases = incident case in epidemiology. Might be more accurate to say, "incident cases of a disease&#x0201d; and add within bracket &#x0201c;(corresponding to the vertical y-axis)&#x0201d;.</p></list-item><list-item><p>&#x0201c;[&#x02026;] per time unit based [&#x02026;]&#x0201d; - Consider 'time interval' instead of 'unit' as &#x02018;unit&#x02019; can be misunderstood (e.g. unit = hour, min, sec). The interval is at the user's discretion (3 hours = 'time interval&#x02019;).</p></list-item><list-item><p>&#x0201c;[&#x02026;]: on the date or time of symptom onset&#x0201d; - Consider replacing symptoms by &#x0201c;time of illness onset among cases&#x0201d; (and add within bracket &#x0201c;(corresponding to the vertical x-axis)&#x0201d;.</p></list-item></list> Comment 7:
<list list-type="bullet"><list-item><p>&#x0201c;provide a simple, visual outline of epi&#x000ad;demic dynamics, which can be used for assessing the growth or decline of an&#x0201d; - That is the main purpose in practice. You may consider&#x000a0;being more assertive, by&#x000a0;replacing "can" with "is". Very well-known added-values. No need for six references to support this statement.</p></list-item></list> Comment 8:
<list list-type="bullet"><list-item><p>&#x0201c;[&#x02026;] by a range of modelling techniques for short-term forecasting (Cori
<italic>et al</italic>., 2013; Funk
<italic>et al</italic>., 2018; Nouvellet
<italic>et al</italic>., 2018; Viboud
<italic>et al</italic>., 2018)&#x0201d; - Could you please consider developing with few sentences pointing to ad hoc examples in relation with the features of the cited references.</p></list-item></list> Comment 9:
<list list-type="bullet"><list-item><p>&#x0201c;[&#x02026;] as well as in outbreak detection algorithms from syndromic surveillance data&#x0201d; - Consider more references that are recent. Note such analytical frameworks are not restricted to syndromic surveillance but to any regularly collected count data from epidemiological time-series in health surveillance system (syndromic or not).</p></list-item></list> Comment 10:
<list list-type="bullet"><list-item><p>&#x0201c;[&#x02026;] But despite the existence of packages dedicated to time series analysis (Shumway &#x00026; Stoffer, 2010) as well as surveillance data (H&#x000f6;hle, 2007)&#x0201d; - Time series analysis is a generic term, consider &#x0201c;time series of epidemiological data&#x0201d; to be more accurate. Numerous time-series packages are available for count data that can be "re-used" for human epi.</p></list-item></list> Comment 11:
<list list-type="bullet"><list-item><p>&#x0201c;a lightweight and
<italic>well-tested </italic>package solely dedicated to building, handling and plotting epidemic curves directly from linelist data (e.g. a spreadsheet where each row represents an individual case) is still lacking.&#x0201d; - Perhaps &#x0201c;lightweight&#x0201d; is something relative in package development and might be changed. More importantly, as mentioned above, please, consider mentioning other previous packages supporting specifically epi-curve creation (for instance: epitools, EpiCurve). These packages can manage aggregated/no aggregated data with and without factor. Current presented package has an added-value is its interoperability, the presence of simple modelling tools and further graph customization. Stricto sensu, epicurve were able to be done in R form user customization of ggplot2 and cited package.</p></list-item></list>
<bold>Section: Methods</bold>
</p><p> Comment 12:
<list list-type="bullet"><list-item><p>&#x0201c;[...] some additional facilities for basic models of incidence over time.&#x0201d; -&#x000a0;Consider &#x0201c;additional features&#x0201d; instead.</p></list-item></list> Comment 13:
<list list-type="bullet"><list-item><p>&#x0201c;[...] an indication of whether incidence is cumulative or not&#x0201d; -&#x000a0;Consider &#x0201c;whether the case count is cumulative&#x0201d;.</p></list-item></list> Comment 14:
<list list-type="bullet"><list-item><p>&#x0201c;[&#x02026;] representing dates including Date and POSIXct objects&#x0201d;. - The EpiCurve package supports hourly data. This intends to cope with some peculiar situation in which an hourly epi-curve can be of interest (acute food intoxication or environmental source). Could give an example with hourly data (it should be fairly easy as POSIXct is date format in the ggplot2 framework). See an example here:&#x000a0;
<ext-link ext-link-type="uri" xlink:href="https://www.cambridge.org/core/journals/epidemiology-and-infection/article/unusually-high-illness-severity-and-short-incubation-periods-in-two-foodborne-outbreaks-of-salmonella-heidelberg-infections-with-potential-coincident-staphylococcus-aureus-intoxication/FED73E4BCEFC109DA327F2909B80BBA7/core-reader">https://www.cambridge.org/core/journals/epidemiology-and-infection/article/unusually-high-illness-severity-and-short-incubation-periods-in-two-foodborne-outbreaks-of-salmonella-heidelberg-infections-with-potential-coincident-staphylococcus-aureus-intoxication/FED73E4BCEFC109DA327F2909B80BBA7/core-reader</ext-link>
</p></list-item></list> Comment 15:
<list list-type="bullet"><list-item><p>&#x0201c;The dates are aggre&#x000ad;gated into counts based on the user-defined interval representing the number of days for each bin.&#x0201d;- Consider 'user-defined time interval' instead of user-defined interval.</p></list-item><list-item><p>&#x0201c;number of days for each bin&#x0201d; -&#x000a0;&#x0201c;days&#x0201d; is too restrictive. It is just the chosen time interval, it can be the number of weeks, etc.</p></list-item></list> Comment 16:
<list list-type="bullet"><list-item><p>&#x0201c;also accepts a groups argument which can be used to obtain stratified incidence&#x0201c; -Consider changing stratified incidence by &#x0201c;epidemiological curve".</p></list-item></list> Comment 17:
<list list-type="bullet"><list-item><p>&#x0201c;The basic elements of the incidence object can be obtained by the accessors get_counts(), get_dates(), and get_interval()." - Please, number the number of basic elements for clarity purpose.</p></list-item></list> Comment 18:
<list list-type="bullet"><list-item><p>&#x0201c;The function subset() can be used for isolating case data from a specific time window and/or groups, while the [ operator can be used for a finer control to subset dates and groups using integer, logical or character vectors.&#x0201d; - If several functions are to be presented, it is easier to use bullet points to structure the reading.&#x000a0;</p></list-item><list-item><p>Consider the removal 'for isolating case data from a specific' and changing with 'to define'.</p></list-item><list-item><p>&#x0201c;[&#x0201c; change to 'indexing operator, to follow the classical denomination
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/doc/manuals/r-release/R-lang.pdf">https://cran.r-project.org/doc/manuals/r-release/R-lang.pdf</ext-link>.</p></list-item></list> Comment 19:
<list list-type="bullet"><list-item><p>&#x0201c;Figure 1. Generalized workflow from incidence object construction to modeling and visualization.&#x0201d; - The first example in the paper is using a line-list format as data inputs but showed a stratified graphic. To be consistent and easier to follow for the reader, this figure illustrates the flow of such of data type, knowing that line-list is the primary source of epidemiological surveillance. A solution present in the figure is the two types of data inputs (non-aggregated/aggregated count). It would be easier, from a reader point of view, to capture the data flow from the line-lit to the final products proposed by this package.</p></list-item></list> Comment 20:
<list list-type="bullet"><list-item><p>&#x0201c;The function pool() can be used to merge several groups into one,&#x0201d; - Consider ending the sentence and explaining what it does.</p></list-item><list-item><p>&#x0201c;and the function cumulate() will turn incidence data into cumulative incidence&#x0201d; - Consider changing &#x0201c;cumulative incidence&#x0201d; to &#x0201c;cumulative count of cases&#x0201d;.</p></list-item></list> Comment 21:
<list list-type="bullet"><list-item><p>[&#x02026;]: an option for a &#x02018;long&#x02019; format which is readily compatible with
<italic>ggplot2 </italic>(Wickham, 2016) for further customization of graphics.&#x0201d; - Would it be possible to mention how date format is exported? This might good to elaborate a bit more about date and user's customization with ggplot2. This can be addressed later in the manuscript (see proposal for a theme).</p></list-item></list> Comment 22:
<list list-type="bullet"><list-item><p>&#x0201c;In line with
<underline>RECON&#x02019;s development guidelines</underline>, the
<italic>incidence </italic>package is thoroughly&#x0201d; - Add a hyperlink/ref. to the website:
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/resources/guidelines/">https://www.repidemicsconsortium.org/resources/guidelines/</ext-link>
</p></list-item></list>
<bold>Section: Modelling utilities</bold>
</p><p> Comment 23:
<list list-type="bullet"><list-item><p>&#x0201c;Here, we highlight three simple functionalities in
<italic>incidence </italic>for estimating parameters via modelling or bootstrap and the two specialized data classes that are used to store the models and parameter estimates.&#x0201d; - Consider structuring the following section according to the five elements mentioned (=three functions [
<underline>fit() , </underline>estimate_peak() , fit_optim_split()] and two specialized data classes) using for instance bullet points/subtitles. For each function, the goal, data input, statistical methods and output object(s) can be grouped in single section.</p></list-item></list> Comment 24:
<list list-type="bullet"><list-item><p>&#x0201c;we implement the simple log-linear regression approach in the function
<underline>fit()</underline>, which can [&#x02026;]" - Please add more information about the structure of the 'incidence_fit objects containing log-linear models'</p></list-item></list> Comment 25:
<list list-type="bullet"><list-item><p>&#x0201c;[&#x02026;] fit exponential increase or decrease of incidence over time by log-transforming case counts &#x02026; &#x0201c; - Can be simplified to&#x000a0;&#x0201c;fit exponential increase or decrease using a linear regression over time on log-transformed case counts&#x02026;&#x0201c;.</p></list-item></list> Comment 26:
<list list-type="bullet"><list-item><p>&#x0201c;where
<italic>y </italic>is the incidence,
<italic>r </italic>is the growth rate,
<italic>t"</italic>&#x000a0;- Replace &#x0201c;incidence&#x0201d; with number of new case/incident case.</p></list-item></list> Comment 27:
<list list-type="bullet"><list-item><p>&#x0201c;serial interval&#x0201d; - Consider adding &#x0201c;serial interval of the infectious agent&#x0201d;</p></list-item></list> Comment 28:
<list list-type="bullet"><list-item><p>&#x0201c;uses multinomial bootstrapping to estimate the peak, assuming&#x0201d; - Some explanation about the method and references would be desirable.</p></list-item></list> Comment 29:
<list list-type="bullet"><list-item><p>&#x0201c;Both object classes can be plotted separately or added to an existing epicurve using the function add_incidence_fit() (Figure 5)."&#x000a0;- The customization of the epicurve is well described. However, it is not mentioned how to change the layout of the model outcome and confidence interval. Indeed, some users might wish to use an alternative ggplot2 geometric object such as geom_range with a shaded grey semi-transparent band instead of two dotted lines. It would an added-value to provide some capacities or explanation and an example of customization of the layout of the &#x0201c;incidence_fit objects&#x0201d;.</p></list-item></list>
<bold>Section: Use cases</bold>
</p><p> Comment 30:
<list list-type="bullet"><list-item><p>&#x0201c;Two worked examples are used to demonstrate the functionality and flexibility of the
<italic>incidence </italic>package. The first example illustrates how to compute and manipulate stratified weekly incidence directly from a line-list&#x0201d;. - Consider &#x0201c;The first example illustrates how to create directly from a line-list incidence object in order draw an epicurve of the weekly number of cases with or without stratification on patient characteristics&#x0201d;.</p></list-item></list> Comment 31:
<list list-type="bullet"><list-item><p>&#x0201c;while the second example shows how to import pre-computed daily incidence and fit a log-linear model to estimate growth rate (
<italic>r</italic>) and doubling time for the growing phase.&#x0201d; - Footnote to be included in the section about the function for more clarity.</p></list-item></list>
</p><p>
<bold>Example 1: computing and manipulating stratified weekly incidence</bold>
</p><p> Comment 32:
<list list-type="bullet"><list-item><p>&#x0201c;The weekly incidence stratified by hospitals is computed by running the function incidence() on the
<underline>D</underline>ate vari&#x000ad;able dat1$date_of_onset with the arguments interval = 7 and groups = dat1$hospital." - Consider rephrasing. For instance: &#x0201c;the epicurve with the weekly number of cases by hospital can be computed from the line listing dataframe object (dat1) using the function incidence() on i) the date vari&#x000ad;able (dat1$date_of_onset), ii) by specifying the argument interval of seven days in order to aggregate the number case per week (interval = 7) and iii) including a the line-listing variable for stratification in the argument groups, in this case the hospital name (groups = dat1$hospital).</p></list-item></list> Comment 33:
<list list-type="bullet"><list-item><p>&#x0201c;Here
<underline>$</underline>count is a matrix with 56 rows and 6 columns as groups by hospital&#x0201d; - Missing s at the end of $counts.</p></list-item></list> Comment 34:
<list list-type="bullet"><list-item><p>&#x0201c;The generic plot() method for incidence objects calls the specific function plot.incidence(), which makes an incidence barplot using the
<italic>ggplot2 </italic>package. Hence, customization of
<italic>incidence </italic>plot can benefit from the powerful graphical language from
<italic>ggplot2</italic>.&#x0201d; - A short explanation and command line to explain how to access the code of the method would be welcome (notably the plot). This would help users to understand which ggplot2 geometric object(s) is used for the bar plot and incidence_fit lines. This would be an asset to understand how to proceed with further customization (within the aesthetic, theme or faceting specifications). This can be proposed at the end through several examples.</p></list-item></list> Comment 35:
<list list-type="bullet"><list-item><p># plot incidence object</p><p> my_theme &#x0003c;-theme_bw(base_size = 12) +</p><p> theme(panel.grid.minor = element_blank()) +</p><p> theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black")) plot(i.7.group, border = "white") + my_theme + theme(legend.position = c(0.8, 0.75))</p></list-item></list> The current example assumes that all users are familiar with ggplot2, notably how to customize the non-data components through the theme. We might suggest to introduce what is a theme in ggplot2 and what it does, for instance &#x0201c;Themes allows modification (content and layouts) of non-data components such as titles, axis labels, legends (position and aspect &#x02026;), graphics grid lines and backgrounds (Modify components of a theme; ref:
<ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org/reference/theme.html">https://ggplot2.tidyverse.org/reference/theme.html</ext-link>)&#x0201d;.</p><p> In addition, mention that theme specifications can &#x0201c;overwrite&#x0201d; some layout specification in the other part of the ggplot2 function. The use in this example of theme_bw appears to clarify what the default built-in theme is (complete themes:&#x000a0;
<ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org/reference/ggtheme.html">https://ggplot2.tidyverse.org/reference/ggtheme.html</ext-link> , other themes
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/ggthemes/ggthemes.pdf">https://cran.r-project.org/web/packages/ggthemes/ggthemes.pdf</ext-link>).</p><p> To help the reader, you might consider the arguments as displayed in &#x0201c;Modify components of a theme&#x0201d; order as much as possible:
<list list-type="bullet"><list-item><p>my_theme &#x0003c;-theme_bw(base_size = 12) +</p><p> theme (</p><p> panel.grid.minor = element_blank,</p><p> axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black"),</p><p> legend.position = c(0.8, 0.75)</p><p> )</p></list-item></list> For this first example, consider setting the legend outside of the main graphic frame, especially for the first figure (instance legend.position="bottom", legend.box = "horizontal").</p><p> For the axis labels, the Y is family the &#x0201c;Num. of case of EVD. per week&#x0201d; in the Figure 2.</p><p> Comment 36:
<list list-type="bullet"><list-item><p>i.7.sub &#x0003c;- i.7.group[1:18, grep("Hospital", group_names(1.7.group))]</p><p> hosp_colors &#x0003c;-c("#899DA4", "#C93312", "#FAEFD1", "#DC863B")</p><p> -&#x000a0;Add an intermediate line to illustrate that in this period selection (e.g. print i.7), cases are coming from four hospitals, to hosp_colors would a four colours vector. Keep the legend out of the main graphic frame (top or bottom).</p></list-item></list> Comment 37:
<list list-type="bullet"><list-item><p>&#x0201c;Here, because of the few numbers of cases in the first few weeks, we have also highlighted each case using show_ cases = TRUE (Figure 3)&#x0201d;. - The figure is displaying the individual case which is the standard representation of an epicurve according to number of training programs (US CDC, EPIET &#x02026;). This is of primary importance in outbreak investigation to able to delineate case number in an easy-to-read visual and often stratified representation by case characteristics (sex, exposure, location &#x02026;).&#x000a0; This type of representation is adopted by default in package EpiCurve (see&#x000a0;
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/EpiCurve/vignettes/EpiCurve.pdf">https://cran.r-project.org/web/packages/EpiCurve/vignettes/EpiCurve.pdf</ext-link>) as well as US CDC training example of epicurve (
<ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/training/quicklearns/createepi/">https://www.cdc.gov/training/quicklearns/createepi/</ext-link>). Representation of case as square can be achieved with the current package as illustrated in at the end of the package vignette (see: vignette ("customize_plot", package="incidence") in the section Applying the style of European Programme for Intervention Epidemiology Training (EPIET). It&#x02019;s understandable that square form can be changed in case of a large dataset making the size of the intervals for the x- and y- axes different.</p><p> It would be an asset for the target audience and the current manuscript to contain a full example of an epicure with case made under square representation (somehow close to the example cited above in the vignette) combined with a full theme following simple and standard representation.</p></list-item></list> Comment 38
<list list-type="bullet"><list-item><p>Consider change in the layout of Figure 2: 'Number of EVD cases stratified by hospital ... between week XX and week YY'.</p><p> Y axis title: 'Number of cases'</p><p> X axis title: 'Week of onset of illness'</p><p> X axis ticks should be made visible for all weeks even the label displayed for any other week.</p></list-item></list> Comment 39:
<list list-type="bullet"><list-item><p>Would it be possible to give some more information to which ggplot2 geometry are used when show_ cases = TRUE is specified? This is of importance to provide the reader with a clue about how both borderline and colour content of each square can be further customized.</p></list-item></list> Comment 40:
<list list-type="bullet"><list-item><p>As standard the label of the X axis time interval is displayed on the left side of the bin. Formally, the ideal position would be right below the bin (as illustrated in the CDC example above and numerous of published epicurve). In the EpiCurve package, the standard representation is not ideal as the X axis tick is right in the middle of the bin. The position of the label can be customized by the user, but would it be possible to look at the option to place the time label under each bin instead of to the left bin tick mark (see an example of ad hoc customization below). Of note, such label position should support figure export resizing.</p></list-item></list> Comment 41:</p><p> Figure 4. (A) stratified and (B) pooled daily incidence plots of ZVD in Colombia, September 2015 to January 2016.</p><p> Please consider comments made above for the other figure on figure title and axis labels:
<list list-type="bullet"><list-item><p>&#x0201c;Epicurve of the daily number of Zika virus disease between Sep and Jan 2016&#x0201d;. Panel (A) stratified by location and (B) pooled across locations. &#x0201c;</p></list-item><list-item><p>Y axis title: 'Number of cases'</p></list-item><list-item><p>X axis title: ' Week of onset of illness'</p></list-item></list> Some readers might wonder if the faceting capabilities of ggplot2 would be supported or not. An evident alternative is to prepare separated epicurve for the both locations and further combined them using specific package (ggarrange for instance). Would it be possible to add information on this point, and if supported, provide an alternative presentation of the both epicurves using two vertically aligned panels?</p><p> Comment 42:
<list list-type="bullet"><list-item><p>&#x0201c;Without any knowledge on the splitting date, we can turn to the fit_optim_split() function to look for the optimal splitting date&#x0201d;. - Could you please reconsider the phrasing as &#x0201c;Without any knowledge on the splitting date&#x0201d; which seems not logical when looking retrospectively to an outbreak epicurve and visually identifying the peak of the epidemic wave.</p></list-item></list> Comment 43:
<list list-type="bullet"><list-item><p>library('magrittr') - Provide a short explanation about the dependency(ies) with this package.</p></list-item></list> Comment 44:
<list list-type="bullet"><list-item><p>&#x0201c;The predictions and their 95% CIs from the two incidence_ft objects, &#x02018;before&#x02019; and &#x02018;after&#x02019;, can be added to the existing incidence plot of i.pooled using the piping-friendly function add_incidence_fit().&#x0201d; - Provide more explanation on &#x0201c;the piping-friendly function&#x0201d; aspect. Provide an example of layout customization of the two log-linear regression models (linetype, colour, size).</p></list-item></list> Comment 45:
<list list-type="bullet"><list-item><p>Please find below a proposal for an advanced and custom-made layout epicurve representation using the Zika dataset. In this example, some of the important layout feature of an epicurve are available: i) no space around the limits of both x and Y axes, ii) representation of each case with a square, iii) x label under each bin and make the graphic as light as possible based on Tufte&#x02019;s advice (less grid as possible, visible labels &#x02026;).</p></list-item><list-item><p>In the graphic below, an incidence_fit object can be added for the pooled location with a specific customization to give a complete overview to the package capabilities.</p></list-item></list> &#x000a0;</p><p>
<bold>Working example based on Zika diease dataset:</bold>
</p><p>
<bold> &#x000a0;</bold>
</p><p> head(zika_girardot_2015, 20)</p><p> head(zika_sanandres_2015, 20)</p><p> dat2 &#x0003c;- merge(zika_girardot_2015, zika_sanandres_2015, by = "date", all = TRUE) # # combine two datasets into one</p><p> names(dat2)[2:3] &#x0003c;- c("Girardot", "San Andres") # rename variables</p><p> dat2[is.na(dat2)] &#x0003c;- 0 # replace NA with 0</p><p> i.group &#x0003c;- as.incidence(x = dat2[, 2:3], dates = dat2$date) # convert pre-computed incidence in data.frame into</p><p> str(i.group)</p><p> # Graphic</p><p> i.group_zoom_in &#x0003c;- i.group[10:60]</p><p> plot(i.group_zoom_in, n_breaks = nrow(i.group_zoom_in),&#x000a0; border = "grey90", show_cases=TRUE) +</p><p> &#x000a0; theme_bw() +</p><p> &#x000a0; scale_y_continuous(expand = c(0, 0), limits=c(0,max(i.group_zoom_in$counts +1))) +</p><p> &#x000a0; scale_x_date(date_breaks = "1 day", date_labels = "%b %d",expand = c(0, 0), limits= c(as.Date(min(i.group_zoom_in$dates)) , as.Date(max(i.group_zoom_in$dates+1)))) +</p><p> &#x000a0;#&#x000a0; scale_fill_discrete(name = "Location:") +</p><p> &#x000a0; #scale_x_continuous(expand = c(0, 0),limits= c(as.Date(min(zomm_in$dates)) , as.Date(max(zomm_in$dates)))) +</p><p> &#x000a0; labs(title = "Number of Zika disease cases",</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; subtitle = "Girardot and San Andres municipalities, Colombia. Period: 6 Sep to 11 Oct 2015." ,</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; x="Week of onset of illness",</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; y="Number of cases",</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; fill="Municipalities:") +</p><p> &#x000a0; theme(panel.border = element_rect(colour = "white"),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; panel.grid.major.y = element_line(colour = "grey70", linetype="dotted", size =0.5),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; axis.line = element_line(colour = "black", size = 0.7),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; axis.text.x = element_text(angle = 45, hjust = 0.8, size = 6),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; axis.ticks.x =&#x000a0; element_line(size = rel(2)),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; axis.ticks.y =&#x000a0; element_line(size = rel(2)),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; axis.title.y = element_text(margin=margin(0,10,0,0), size=10),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; axis.title.x = element_text(margin=margin(10,0,0,0), size=10),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; plot.title =&#x000a0; element_text(size = 12,face = "bold"),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; plot.subtitle =&#x000a0; element_text(size = 9),</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; legend.position="bottom",</p><p> &#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0; legend.box = "horizontal") +</p><p> &#x000a0; coord_equal()</p><p> Link to plot available
<ext-link ext-link-type="uri" xlink:href="https://f1000researchdata.s3.amazonaws.com/linked/246408.Sudre_Graph.png">here</ext-link>.&#x000a0;</p><p>
<bold>Is the rationale for developing the new software tool clearly explained?</bold>
</p><p> Yes. The rational is sounds and the new package &#x0201c;Incidence&#x0201d; is fulfilling the objectives cited. It allows streamlining the manipulation and representation for epidemiological data for epidemiological representation. It expected that this new package would reach a wide audience of epidemiologists and epidemiological data analysts working with R.</p><p>
<bold>Is the description of the software tool technically sound?</bold>
</p><p> Yes. However, some clarifications proposed in the detailed review would enhance the description of the software tool features.</p><p>
<bold>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</bold>
</p><p> Overall, yes. Minor adjustments are proposed to allow reader to better access code (e.g. provide example to access full code of incidence (S3) class incidence &#x000a0;and its subsequent methods (plot, &#x02026;)) and offer additional &#x000a0;clarification to improve graphic customization (notably around the incidence_fit object and further integration of ggplot2&#x000a0; faceting functionality).</p><p>
<bold>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</bold>
</p><p> Yes. Several practical and realistic examples are provided by the authors. All examples were tested and further tests with epidemiological additional datasets were conducted and allow to reproduce accurately tool behaviours. In addition to the paper review, the R package documentation (description file, recent reference manual and vignettes) were thoroughly reviewed to assess any discrepancies between the peer-review publication and package documentation on CRAN.</p><p>
<bold>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</bold>
</p><p> Yes.</p><p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p></body><back><ref-list><title>References</title><ref id="rep-ref-48153-1"><label>1</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Cori</surname><given-names>A</given-names></name><name><surname>Ferguson</surname><given-names>NM</given-names></name><name><surname>Fraser</surname><given-names>C</given-names></name><name><surname>Cauchemez</surname><given-names>S</given-names></name></person-group>:
<article-title>A new framework and software to estimate time-varying reproduction numbers during epidemics.</article-title>
<source><italic>Am J Epidemiol</italic></source>.<year>2013</year>;<volume>178</volume>(<issue>9</issue>) :
<elocation-id>10.1093/aje/kwt133</elocation-id>
<fpage>1505</fpage>-<lpage>12</lpage>
<pub-id pub-id-type="doi">10.1093/aje/kwt133</pub-id>
<?supplied-pmid 24043437?><pub-id pub-id-type="pmid">24043437</pub-id></mixed-citation></ref><ref id="rep-ref-48153-2"><label>2</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kraemer</surname><given-names>MUG</given-names></name><name><surname>Cummings</surname><given-names>DAT</given-names></name><name><surname>Funk</surname><given-names>S</given-names></name><name><surname>Reiner</surname><given-names>RC</given-names></name><name><surname>Faria</surname><given-names>NR</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Cauchemez</surname><given-names>S</given-names></name></person-group>:
<article-title>Reconstruction and prediction of viral disease epidemics.</article-title>
<source><italic>Epidemiol Infect</italic></source>.<year>2018</year>;
<elocation-id>10.1017/S0950268818002881</elocation-id>
<fpage>1</fpage>-<lpage>7</lpage>
<pub-id pub-id-type="doi">10.1017/S0950268818002881</pub-id>
<?supplied-pmid 30394230?><pub-id pub-id-type="pmid">30394230</pub-id></mixed-citation></ref><ref id="rep-ref-48153-3"><label>3</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Siddle</surname><given-names>K</given-names></name><name><surname>Eromon</surname><given-names>P</given-names></name><name><surname>Barnes</surname><given-names>K</given-names></name><name><surname>Mehta</surname><given-names>S</given-names></name><name><surname>Oguzie</surname><given-names>J</given-names></name><name><surname>Odia</surname><given-names>I</given-names></name><name><surname>Schaffner</surname><given-names>S</given-names></name><name><surname>Winnicki</surname><given-names>S</given-names></name><name><surname>Shah</surname><given-names>R</given-names></name><name><surname>Qu</surname><given-names>J</given-names></name><name><surname>Wohl</surname><given-names>S</given-names></name><name><surname>Brehio</surname><given-names>P</given-names></name><name><surname>Iruolagbe</surname><given-names>C</given-names></name><name><surname>Aiyepada</surname><given-names>J</given-names></name><name><surname>Uyigue</surname><given-names>E</given-names></name><name><surname>Akhilomen</surname><given-names>P</given-names></name><name><surname>Okonofua</surname><given-names>G</given-names></name><name><surname>Ye</surname><given-names>S</given-names></name><name><surname>Kayode</surname><given-names>T</given-names></name><name><surname>Ajogbasile</surname><given-names>F</given-names></name><name><surname>Uwanibe</surname><given-names>J</given-names></name><name><surname>Gaye</surname><given-names>A</given-names></name><name><surname>Momoh</surname><given-names>M</given-names></name><name><surname>Chak</surname><given-names>B</given-names></name><name><surname>Kotliar</surname><given-names>D</given-names></name><name><surname>Carter</surname><given-names>A</given-names></name><name><surname>Gladden-Young</surname><given-names>A</given-names></name><name><surname>Freije</surname><given-names>C</given-names></name><name><surname>Omoregie</surname><given-names>O</given-names></name><name><surname>Osiemi</surname><given-names>B</given-names></name><name><surname>Muoebonam</surname><given-names>E</given-names></name><name><surname>Airende</surname><given-names>M</given-names></name><name><surname>Enigbe</surname><given-names>R</given-names></name><name><surname>Ebo</surname><given-names>B</given-names></name><name><surname>Nosamiefan</surname><given-names>I</given-names></name><name><surname>Oluniyi</surname><given-names>P</given-names></name><name><surname>Nekoui</surname><given-names>M</given-names></name><name><surname>Ogbaini-Emovon</surname><given-names>E</given-names></name><name><surname>Garry</surname><given-names>R</given-names></name><name><surname>Andersen</surname><given-names>K</given-names></name><name><surname>Park</surname><given-names>D</given-names></name><name><surname>Yozwiak</surname><given-names>N</given-names></name><name><surname>Akpede</surname><given-names>G</given-names></name><name><surname>Ihekweazu</surname><given-names>C</given-names></name><name><surname>Tomori</surname><given-names>O</given-names></name><name><surname>Okogbenin</surname><given-names>S</given-names></name><name><surname>Folarin</surname><given-names>O</given-names></name><name><surname>Okokhere</surname><given-names>P</given-names></name><name><surname>MacInnis</surname><given-names>B</given-names></name><name><surname>Sabeti</surname><given-names>P</given-names></name><name><surname>Happi</surname><given-names>C</given-names></name></person-group>:
<article-title>Genomic Analysis of Lassa Virus during an Increase in Cases in Nigeria in 2018</article-title>.
<source><italic>New England Journal of Medicine</italic></source>.<year>2018</year>;<volume>379</volume>(<issue>18</issue>) :
<elocation-id>10.1056/NEJMoa1804498</elocation-id>
<fpage>1745</fpage>-<lpage>1753</lpage>
<pub-id pub-id-type="doi">10.1056/NEJMoa1804498</pub-id>
</mixed-citation></ref><ref id="rep-ref-48153-4"><label>4</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kafetzopoulou</surname><given-names>L</given-names></name><name><surname>Pullan</surname><given-names>S</given-names></name><name><surname>Lemey</surname><given-names>P</given-names></name><name><surname>Suchard</surname><given-names>M</given-names></name><name><surname>Ehichioya</surname><given-names>D</given-names></name><name><surname>Pahlmann</surname><given-names>M</given-names></name><name><surname>Thielebein</surname><given-names>A</given-names></name><name><surname>Hinzmann</surname><given-names>J</given-names></name><name><surname>Oestereich</surname><given-names>L</given-names></name><name><surname>Wozniak</surname><given-names>D</given-names></name><name><surname>Efthymiadis</surname><given-names>K</given-names></name><name><surname>Schachten</surname><given-names>D</given-names></name><name><surname>Koenig</surname><given-names>F</given-names></name><name><surname>Matjeschk</surname><given-names>J</given-names></name><name><surname>Lorenzen</surname><given-names>S</given-names></name><name><surname>Lumley</surname><given-names>S</given-names></name><name><surname>Ighodalo</surname><given-names>Y</given-names></name><name><surname>Adomeh</surname><given-names>D</given-names></name><name><surname>Olokor</surname><given-names>T</given-names></name><name><surname>Omomoh</surname><given-names>E</given-names></name><name><surname>Omiunu</surname><given-names>R</given-names></name><name><surname>Agbukor</surname><given-names>J</given-names></name><name><surname>Ebo</surname><given-names>B</given-names></name><name><surname>Aiyepada</surname><given-names>J</given-names></name><name><surname>Ebhodaghe</surname><given-names>P</given-names></name><name><surname>Osiemi</surname><given-names>B</given-names></name><name><surname>Ehikhametalor</surname><given-names>S</given-names></name><name><surname>Akhilomen</surname><given-names>P</given-names></name><name><surname>Airende</surname><given-names>M</given-names></name><name><surname>Esumeh</surname><given-names>R</given-names></name><name><surname>Muoebonam</surname><given-names>E</given-names></name><name><surname>Giwa</surname><given-names>R</given-names></name><name><surname>Ekanem</surname><given-names>A</given-names></name><name><surname>Igenegbale</surname><given-names>G</given-names></name><name><surname>Odigie</surname><given-names>G</given-names></name><name><surname>Okonofua</surname><given-names>G</given-names></name><name><surname>Enigbe</surname><given-names>R</given-names></name><name><surname>Oyakhilome</surname><given-names>J</given-names></name><name><surname>Yerumoh</surname><given-names>E</given-names></name><name><surname>Odia</surname><given-names>I</given-names></name><name><surname>Aire</surname><given-names>C</given-names></name><name><surname>Okonofua</surname><given-names>M</given-names></name><name><surname>Atafo</surname><given-names>R</given-names></name><name><surname>Tobin</surname><given-names>E</given-names></name><name><surname>Asogun</surname><given-names>D</given-names></name><name><surname>Akpede</surname><given-names>N</given-names></name><name><surname>Okokhere</surname><given-names>P</given-names></name><name><surname>Rafiu</surname><given-names>M</given-names></name><name><surname>Iraoyah</surname><given-names>K</given-names></name><name><surname>Iruolagbe</surname><given-names>C</given-names></name><name><surname>Akhideno</surname><given-names>P</given-names></name><name><surname>Erameh</surname><given-names>C</given-names></name><name><surname>Akpede</surname><given-names>G</given-names></name><name><surname>Isibor</surname><given-names>E</given-names></name><name><surname>Naidoo</surname><given-names>D</given-names></name><name><surname>Hewson</surname><given-names>R</given-names></name><name><surname>Hiscox</surname><given-names>J</given-names></name><name><surname>Vipond</surname><given-names>R</given-names></name><name><surname>Carroll</surname><given-names>M</given-names></name><name><surname>Ihekweazu</surname><given-names>C</given-names></name><name><surname>Formenty</surname><given-names>P</given-names></name><name><surname>Okogbenin</surname><given-names>S</given-names></name><name><surname>Ogbaini-Emovon</surname><given-names>E</given-names></name><name><surname>G&#x000fc;nther</surname><given-names>S</given-names></name><name><surname>Duraffour</surname><given-names>S</given-names></name></person-group>:
<article-title>Metagenomic sequencing at the epicenter of the Nigeria 2018 Lassa fever outbreak</article-title>.
<source><italic>Science</italic></source>.<year>2019</year>;<volume>363</volume>(<issue>6422</issue>) :
<elocation-id>10.1126/science.aau9343</elocation-id>
<fpage>74</fpage>-<lpage>77</lpage>
<pub-id pub-id-type="doi">10.1126/science.aau9343</pub-id>
</mixed-citation></ref></ref-list></back></sub-article><sub-article id="report45525" article-type="peer-review"><front-stub><article-id pub-id-type="doi">10.5256/f1000research.19688.r45525</article-id><title-group><article-title>Reviewer response for version 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>ten Bosch</surname><given-names>Quirine</given-names></name><xref ref-type="aff" rid="r45525a1">1</xref><role>Referee</role><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5227-1406</contrib-id></contrib><aff id="r45525a1">
<label>1</label>Quantitative Veterinary Epidemiology, Department of Animal Sciences, Wageningen University and Research Centre, Wageningen, The Netherlands</aff></contrib-group><author-notes><fn fn-type="COI-statement"><p>
<bold>Competing interests: </bold>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>25</day><month>4</month><year>2019</year></pub-date><related-article related-article-type="peer-reviewed-article" id="d35e4571" ext-link-type="doi" xlink:href="10.12688/f1000research.18002.1">Version 1</related-article><custom-meta-group><custom-meta><meta-name>recommendation</meta-name><meta-value>approve</meta-value></custom-meta></custom-meta-group></front-stub><body><p>The authors introduce a package that aids in processing linelist data (
<italic>i.e., </italic>in which each row represents a case) for building, handling, and plotting epidemic curves. This tool fills a gap within the larger epidemics toolbox of the R Epidemics Consortium in &#x02018;getting the basics right&#x02019;, or otherwise put, getting data common to outbreak situations in the right format for further analysis.</p><p> I agree with the authors that this is a helpful tool. This is particularly true during outbreaks, when linelist data need to be processed quickly and disseminated to relevant actors. The procedures are straightforward and well presented. The examples given in this work are well chosen and provide a good starting point for working with this package. I only have a few comments pertaining to i) the loglinear model implementation and presentation and ii) the integration with other packages.
<list list-type="order"><list-item><p>While the package is meant to focus on processing and visualization of data, the authors have added a modeling-capability that estimates epidemic growth rates. The respective function contains an option for estimating the peak of the outbreak and fit the exponential increase or decrease during the epidemic. Basing the time window for exponential growth on the timing of the peak will underestimate the growth rate as growth will no longer be exponential just before the peak of the epidemic. A more careful description in the MS is needed to highlight this and other shortcomings of this approach. Other methods to estimate the best time window, such as those used in the R0-package
<sup><xref rid="rep-ref-45525-1" ref-type="bibr">1</xref></sup>, could prove helpful and be implemented in the package. Further, the choice of fitting the growth rates to the aggregated data rather than the two distinct regions (Girardot and San Andres) is a bit uncomfortable. Particularly so because, as the authors acknowledge, there seem to be two quite distinct outbreaks.</p></list-item><list-item><p>The authors highlight the gap within the epidemics toolbox is filled. It would be nice to see a little bit more context on what packages can easily work with their data structures and what analyses can hence readily be done.</p></list-item></list> Minor comments:
<list list-type="bullet"><list-item><p>Page 7: group_names(1.7.group) should be i.7.group</p></list-item></list>
</p><p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p></body><back><ref-list><title>References</title><ref id="rep-ref-45525-1"><label>1</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Obadia</surname><given-names>T</given-names></name><name><surname>Haneef</surname><given-names>R</given-names></name><name><surname>Bo&#x000eb;lle</surname><given-names>PY</given-names></name></person-group>:
<article-title>The R0 package: a toolbox to estimate reproduction numbers for epidemic outbreaks.</article-title>
<source><italic>BMC Med Inform Decis Mak</italic></source>.<year>2012</year>;<volume>12</volume>:
<elocation-id>10.1186/1472-6947-12-147</elocation-id>
<fpage>147</fpage>
<pub-id pub-id-type="doi">10.1186/1472-6947-12-147</pub-id>
<?supplied-pmid 23249562?><pub-id pub-id-type="pmid">22364529</pub-id></mixed-citation></ref></ref-list></back></sub-article><sub-article id="report45526" article-type="peer-review"><front-stub><article-id pub-id-type="doi">10.5256/f1000research.19688.r45526</article-id><title-group><article-title>Reviewer response for version 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bolker</surname><given-names>Benjamin M.</given-names></name><xref ref-type="aff" rid="r45526a1">1</xref><role>Referee</role><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2127-0443</contrib-id></contrib><aff id="r45526a1">
<label>1</label>Departments of Mathematics and Statistics and Biology, McMaster University, Hamilton, ON, Canada</aff></contrib-group><author-notes><fn fn-type="COI-statement"><p>
<bold>Competing interests: </bold>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>3</day><month>4</month><year>2019</year></pub-date><related-article related-article-type="peer-reviewed-article" id="d35e4696" ext-link-type="doi" xlink:href="10.12688/f1000research.18002.1">Version 1</related-article><custom-meta-group><custom-meta><meta-name>recommendation</meta-name><meta-value>approve-with-reservations</meta-value></custom-meta></custom-meta-group></front-stub><body><p>The authors have written an R package that does some useful tasks in aggregating and manipulating incidences and plotting them. For the most part the paper is clearly written and technically correct, and the package seems well-constructed.&#x000a0;The abstract says that the package is "solely dedicated to building, handling and plotting epidemic curves", although it also fits simple epidemic models to incidence data.</p><p> Overall I think this package is sensible and well-designed.&#x000a0;My only major concern is with the log-linear fitting procedures; on the one hand, the authors say clearly that there are many fitting procedures which cannot (and should not) all be squeezed into this package, and I suspect that they don't intend these fits to be taken as very precise measures of the growth rate. On the other hand, I'm quite concerned by the possibility that users will take growth rates and confidence intervals estimated by these simplistic fits too seriously. There are a number of delicate issues around the estimation of epidemic growth rates:
<list list-type="bullet"><list-item><p>Assume log-Normal incidence (as done by a log-linear fit), or make other distributional assumptions (e.g. Poisson or negative binomial)?</p></list-item><list-item><p>If using exponential or log-linear fits, what time window should one use to capture enough of the beginning of the epidemic but not bias the growth rate downward by capturing the saturation phase of the epidemic (Ma
<italic>et al.</italic>, 2014
<sup><xref rid="rep-ref-45526-1" ref-type="bibr">1</xref></sup>)?</p></list-item><list-item><p>Should one allow for the influence of both process and measurement error (King
<italic>et al.</italic>, 2015
<sup><xref rid="rep-ref-45526-2" ref-type="bibr">2</xref></sup>)?</p></list-item><list-item><p>Is growth exponential or sub-exponential (Viboud
<italic>et al.</italic>, 2016
<sup><xref rid="rep-ref-45526-3" ref-type="bibr">3</xref></sup>)?</p></list-item></list> I think I would have preferred that, if they were not going to go deeply into this area, that the authors instead provide some sort of non-parametric smooth fit (perhaps constraining the changes to be monotonically increasing before the peak and decreasing after the peak) rather than oversimplifying in this way.</p><p> The minimal change that is needed to the document is a stronger set of caveats/warnings to users that the log-linear model may have major shortcomings in some circumstances, and should not be accepted unquestioningly.</p><p> The package suggests that the fit() function is extendable to allow other fitting methods ("While the incidence package returns incidence_fit objects containing log-linear models by default, they can be constructed from any model from which it&#x02019;s possible to extract the growth rate (r) and predict incidence along the model"); I wasn't able to figure out how to achieve that goal.</p><p> The main use of the package is for converting from line lists to aggregated incidence data. It would be useful (I can't tell if it's possible) to easily be able to aggregate data that are already in date/incidence form to coarser scales, or to approximately disaggregate incidence data.</p><p> I had trouble fitting epidemic curves to data sets that only included incidence up to the peak or shortly beyond (it seems that the model was automatically trying to estimate a decline rate as well as an increase rate). This seems like an odd choice for a tool that people may be using to work with data from emerging epidemics that have not yet peaked.</p><p>
<bold>Minor comments:</bold>
<list list-type="bullet"><list-item><p>p. 3, paragraph 1: missing space before (</p></list-item><list-item><p>p. 3, paragraph 3: maybe R "language" or "environment" rather than "software" (R defines itself as "a language and environment for statistical computing and graphics")?</p></list-item><list-item><p>Last paragraph of intro: comma before "which aims to fill this gap"?</p></list-item><list-item><p>Methods, paragraph 2: Probably don't need to say "numeric and integer" values, "numeric" would suffice (is.numeric(1L) is TRUE in R).</p></list-item><list-item><p>Methods, paragraph 2: "can not" -&#x0003e; "cannot".</p></list-item><list-item><p>How do subsets and indexing work with dates?</p></list-item><list-item><p>Figure 1 caption: delete "both"?</p></list-item><list-item><p>"created from these where it checks and validates" -&#x0003e; "created from these components after checking and validating" ?</p></list-item><list-item><p>"[Fitting] of log-linear models is depicted in the lower left"?&#x000a0;(Technically, the addition of log-lin models to the plot is depicted along the bottom edge, or in the lower right).</p></list-item><list-item><p>p. 5: "boo[t]strap".</p></list-item></list>
</p><p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p></body><back><ref-list><title>References</title><ref id="rep-ref-45526-1"><label>1</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Dushoff</surname><given-names>J</given-names></name><name><surname>Bolker</surname><given-names>BM</given-names></name><name><surname>Earn</surname><given-names>DJ</given-names></name></person-group>:
<article-title>Estimating initial epidemic growth rates.</article-title>
<source><italic>Bull Math Biol</italic></source>.<year>2014</year>;<volume>76</volume>(<issue>1</issue>) :
<elocation-id>10.1007/s11538-013-9918-2</elocation-id>
<fpage>245</fpage>-<lpage>60</lpage>
<pub-id pub-id-type="doi">10.1007/s11538-013-9918-2</pub-id>
<?supplied-pmid 24272389?><pub-id pub-id-type="pmid">24272389</pub-id></mixed-citation></ref><ref id="rep-ref-45526-2"><label>2</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>King</surname><given-names>AA</given-names></name><name><surname>Domenech de Cell&#x000e8;s</surname><given-names>M</given-names></name><name><surname>Magpantay</surname><given-names>FM</given-names></name><name><surname>Rohani</surname><given-names>P</given-names></name></person-group>:
<article-title>Avoidable errors in the modelling of outbreaks of emerging pathogens, with special reference to Ebola.</article-title>
<source><italic>Proc Biol Sci</italic></source>.<year>2015</year>;<volume>282</volume>(<issue>1806</issue>) :
<elocation-id>10.1098/rspb.2015.0347</elocation-id>
<fpage>20150347</fpage>
<pub-id pub-id-type="doi">10.1098/rspb.2015.0347</pub-id>
<?supplied-pmid 25833863?><pub-id pub-id-type="pmid">25833863</pub-id></mixed-citation></ref><ref id="rep-ref-45526-3"><label>3</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Viboud</surname><given-names>C</given-names></name><name><surname>Simonsen</surname><given-names>L</given-names></name><name><surname>Chowell</surname><given-names>G</given-names></name></person-group>:
<article-title>A generalized-growth model to characterize the early ascending phase of infectious disease outbreaks.</article-title>
<source><italic>Epidemics</italic></source>.<volume>15</volume>:
<elocation-id>10.1016/j.epidem.2016.01.002</elocation-id>
<fpage>27</fpage>-<lpage>37</lpage>
<pub-id pub-id-type="doi">10.1016/j.epidem.2016.01.002</pub-id>
<?supplied-pmid 27266847?><pub-id pub-id-type="pmid">27266847</pub-id></mixed-citation></ref></ref-list></back></sub-article></article>